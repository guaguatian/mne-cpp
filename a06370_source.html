<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.7"/>
<title>MNE-CPP Documentation</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="customdoxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><a class="site-logo" href="http://www.mne-cpp.org/" title="A Framework for Electrophysiology"><img alt="Logo" src="MNE-CPP_Doxygen_Logo.svg"/></a></td>
  <td style="padding-left: 0.5em;">
   <div id="projectname">MNE-CPP
   &#160;<span id="projectnumber">1.0.0</span>
   </div>
   <div id="projectbrief">A Framework for Electrophysiology</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_a6e4fee11f07c3b70486e88fe92cbbdc.html">applications</a></li><li class="navelem"><a class="el" href="dir_e446c6e1cb3fc1a93d99e5b33bb756bc.html">mne_scan</a></li><li class="navelem"><a class="el" href="dir_dff0cf57900fd280f21b02b063bc8d88.html">plugins</a></li><li class="navelem"><a class="el" href="dir_0d31c1ff52bf5b78a89d1310fa234d57.html">neuromag</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">neuromag.cpp</div>  </div>
</div><!--header-->
<div class="contents">
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">//=============================================================================================================</span></div><div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;<span class="comment"></span><span class="comment">//*************************************************************************************************************</span></div><div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;<span class="comment">//=============================================================================================================</span></div><div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;<span class="comment">// INCLUDES</span></div><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;<span class="comment">//=============================================================================================================</span></div><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;</div><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;<span class="preprocessor">#include &quot;neuromag.h&quot;</span></div><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="a02801.html">neuromagproducer.h</a>&quot;</span></div><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;</div><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="a02795.html">FormFiles/neuromagsetupwidget.h</a>&quot;</span></div><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;</div><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;<span class="preprocessor">#include &lt;<a class="code" href="a00875.html">fiff/fiff_dir_node.h</a>&gt;</span></div><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;<span class="preprocessor">#include &lt;<a class="code" href="a00950.html">fiff/fiff_stream.h</a>&gt;</span></div><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;<span class="preprocessor">#include &lt;<a class="code" href="a02219.html">scMeas/realtimemultisamplearray.h</a>&gt;</span></div><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;<span class="preprocessor">#include &lt;<a class="code" href="a00425.html">disp/viewers/projectsettingsview.h</a>&gt;</span></div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;<span class="preprocessor">#include &lt;<a class="code" href="a00908.html">fiff/fiff_info.h</a>&gt;</span></div><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;<span class="preprocessor">#include &lt;<a class="code" href="a01583.html">utils/ioutils.h</a>&gt;</span></div><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;<span class="preprocessor">#include &lt;<a class="code" href="a00014.html">communication/rtClient/rtcmdclient.h</a>&gt;</span></div><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;<span class="preprocessor">#include &lt;<a class="code" href="a00773.html">disp3D/viewers/hpiview.h</a>&gt;</span></div><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;</div><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;</div><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;<span class="comment">//*************************************************************************************************************</span></div><div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;<span class="comment">//=============================================================================================================</span></div><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;<span class="comment">// QT INCLUDES</span></div><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;<span class="comment">//=============================================================================================================</span></div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;</div><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;<span class="preprocessor">#include &lt;QDir&gt;</span></div><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;<span class="preprocessor">#include &lt;QSettings&gt;</span></div><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;<span class="preprocessor">#include &lt;QMessageBox&gt;</span></div><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;</div><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;</div><div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;<span class="comment">//*************************************************************************************************************</span></div><div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;<span class="comment">//=============================================================================================================</span></div><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;<span class="comment">// USED NAMESPACES</span></div><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;<span class="comment">//=============================================================================================================</span></div><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;</div><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;<span class="keyword">using namespace </span><a class="code" href="a03223.html">NEUROMAGPLUGIN</a>;</div><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;<span class="keyword">using namespace </span><a class="code" href="a03167.html">UTILSLIB</a>;</div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;<span class="keyword">using namespace </span><a class="code" href="a03205.html">SCSHAREDLIB</a>;</div><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;<span class="keyword">using namespace </span><a class="code" href="a03183.html">IOBUFFER</a>;</div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;<span class="keyword">using namespace </span><a class="code" href="a03204.html">SCMEASLIB</a>;</div><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;<span class="keyword">using namespace </span><a class="code" href="a03162.html">FIFFLIB</a>;</div><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;<span class="keyword">using namespace </span><a class="code" href="a03164.html">DISPLIB</a>;</div><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;<span class="keyword">using namespace </span><a class="code" href="a03170.html">DISP3DLIB</a>;</div><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;</div><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;</div><div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;<span class="comment">//*************************************************************************************************************</span></div><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;<span class="comment">//=============================================================================================================</span></div><div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;<span class="comment">// DEFINE MEMBER METHODS</span></div><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;<span class="comment">//=============================================================================================================</span></div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;</div><div class="line"><a name="l00087"></a><span class="lineno"><a class="line" href="a05739.html#a43e8a68cb028823fbbff3eccf373f7e8">   87</a></span>&#160;<a class="code" href="a05739.html#a43e8a68cb028823fbbff3eccf373f7e8">Neuromag::Neuromag</a>()</div><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;: m_sNeuromagClientAlias(<span class="stringliteral">&quot;mne_scan&quot;</span>)</div><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;, m_pRtCmdClient(NULL)</div><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;, m_bCmdClientIsConnected(false)</div><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;, m_sNeuromagIP(<span class="stringliteral">&quot;172.21.16.88&quot;</span>)<span class="comment">//(&quot;127.0.0.1&quot;)</span></div><div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;, m_pNeuromagProducer(new <a class="code" href="a05743.html">NeuromagProducer</a>(this))</div><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;, m_iBufferSize(-1)</div><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;, m_pRawMatrixBuffer_In(0)</div><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;, m_bIsRunning(false)</div><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;, m_sFiffHeader(QCoreApplication::applicationDirPath() + <span class="stringliteral">&quot;/resources/mne_scan/plugins/neuromag/header.fif&quot;</span>)</div><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;, m_iActiveConnectorId(0)</div><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;, m_bWriteToFile(false)</div><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;, m_iRecordingMSeconds(5*60*1000)</div><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;, m_iBlinkStatus(-1)</div><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;, m_iSplitCount(0)</div><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;, m_bUseRecordTimer(false)</div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;{</div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;    <a class="code" href="a05739.html#abd1e2a77ed4a2900a964673110403721">m_pActionSetupProject</a> = <span class="keyword">new</span> QAction(QIcon(<span class="stringliteral">&quot;:/images/database.png&quot;</span>), tr(<span class="stringliteral">&quot;Setup Project&quot;</span>),<span class="keyword">this</span>);</div><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;    <a class="code" href="a05739.html#abd1e2a77ed4a2900a964673110403721">m_pActionSetupProject</a>-&gt;setStatusTip(tr(<span class="stringliteral">&quot;Setup Project&quot;</span>));</div><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;    connect(<a class="code" href="a05739.html#abd1e2a77ed4a2900a964673110403721">m_pActionSetupProject</a>.data(), &amp;QAction::triggered,</div><div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;            <span class="keyword">this</span>, &amp;<a class="code" href="a05739.html#a69de0f8b7594e2b8d15442818bec2971">Neuromag::showProjectDialog</a>);</div><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;    <a class="code" href="a05351.html#acd0c42811d473bfa88b5f280d3da6ca3">addPluginAction</a>(<a class="code" href="a05739.html#abd1e2a77ed4a2900a964673110403721">m_pActionSetupProject</a>);</div><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;</div><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;    <a class="code" href="a05739.html#ab6151b06b751d2323e5358038a29c953">m_pActionRecordFile</a> = <span class="keyword">new</span> QAction(QIcon(<span class="stringliteral">&quot;:/images/record.png&quot;</span>), tr(<span class="stringliteral">&quot;Start Recording&quot;</span>),<span class="keyword">this</span>);</div><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;    <a class="code" href="a05739.html#ab6151b06b751d2323e5358038a29c953">m_pActionRecordFile</a>-&gt;setStatusTip(tr(<span class="stringliteral">&quot;Start Recording&quot;</span>));</div><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;    connect(<a class="code" href="a05739.html#ab6151b06b751d2323e5358038a29c953">m_pActionRecordFile</a>.data(), &amp;QAction::triggered,</div><div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;            <span class="keyword">this</span>, &amp;<a class="code" href="a05739.html#a2a9dff5bc13ed078be5b91def8e34d13">Neuromag::toggleRecordingFile</a>);</div><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;    <a class="code" href="a05351.html#acd0c42811d473bfa88b5f280d3da6ca3">addPluginAction</a>(<a class="code" href="a05739.html#ab6151b06b751d2323e5358038a29c953">m_pActionRecordFile</a>);</div><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;</div><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;    <span class="comment">//Init HPI</span></div><div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;    <a class="code" href="a05739.html#a2e065e423ca60a8fa38d4b71a7e0f1b4">m_pActionComputeHPI</a> = <span class="keyword">new</span> QAction(QIcon(<span class="stringliteral">&quot;:/images/latestFiffInfoHPI.png&quot;</span>), tr(<span class="stringliteral">&quot;Compute HPI&quot;</span>),<span class="keyword">this</span>);</div><div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;    <a class="code" href="a05739.html#a2e065e423ca60a8fa38d4b71a7e0f1b4">m_pActionComputeHPI</a>-&gt;setStatusTip(tr(<span class="stringliteral">&quot;Compute HPI&quot;</span>));</div><div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;    connect(<a class="code" href="a05739.html#a2e065e423ca60a8fa38d4b71a7e0f1b4">m_pActionComputeHPI</a>.data(), &amp;QAction::triggered,</div><div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;            <span class="keyword">this</span>, &amp;<a class="code" href="a05739.html#a61b5f2a5422bac2f377496a86df73d01">Neuromag::showHPIDialog</a>);</div><div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;    <a class="code" href="a05351.html#acd0c42811d473bfa88b5f280d3da6ca3">addPluginAction</a>(<a class="code" href="a05739.html#a2e065e423ca60a8fa38d4b71a7e0f1b4">m_pActionComputeHPI</a>);</div><div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;</div><div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;    <span class="comment">//Init recording timers</span></div><div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;    <a class="code" href="a05739.html#ad189cae0a60196c69a91b679fa7a9cae">m_pRecordTimer</a> = QSharedPointer&lt;QTimer&gt;(<span class="keyword">new</span> QTimer(<span class="keyword">this</span>));</div><div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;    <a class="code" href="a05739.html#ad189cae0a60196c69a91b679fa7a9cae">m_pRecordTimer</a>-&gt;setSingleShot(<span class="keyword">true</span>);</div><div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;    connect(<a class="code" href="a05739.html#ad189cae0a60196c69a91b679fa7a9cae">m_pRecordTimer</a>.data(), &amp;QTimer::timeout,</div><div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;            <span class="keyword">this</span>, &amp;<a class="code" href="a05739.html#a2a9dff5bc13ed078be5b91def8e34d13">Neuromag::toggleRecordingFile</a>);</div><div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;</div><div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;    <a class="code" href="a05739.html#ada25b5fa428e010b621081bcd9a104fe">m_pBlinkingRecordButtonTimer</a> = QSharedPointer&lt;QTimer&gt;(<span class="keyword">new</span> QTimer(<span class="keyword">this</span>));</div><div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;    connect(m_pBlinkingRecordButtonTimer.data(), &amp;QTimer::timeout,</div><div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;            <span class="keyword">this</span>, &amp;<a class="code" href="a05739.html#ad0750b6f0a0d19582a54eb4524a6ce83">Neuromag::changeRecordingButton</a>);</div><div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;</div><div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;    <a class="code" href="a05739.html#af8443795bb2af50bc684598341bff000">m_pUpdateTimeInfoTimer</a> = QSharedPointer&lt;QTimer&gt;(<span class="keyword">new</span> QTimer(<span class="keyword">this</span>));</div><div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;    connect(m_pUpdateTimeInfoTimer.data(), &amp;QTimer::timeout,</div><div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;            <span class="keyword">this</span>, &amp;<a class="code" href="a05739.html#a69ee359f00d290e1b24ecc8875ffceeb">Neuromag::onRecordingRemainingTimeChange</a>);</div><div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;}</div><div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;</div><div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;</div><div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;<span class="comment">//*************************************************************************************************************</span></div><div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;</div><div class="line"><a name="l00141"></a><span class="lineno"><a class="line" href="a05739.html#ab6c91777b8e92e1f48c548d5fccd1beb">  141</a></span>&#160;<a class="code" href="a05739.html#ab6c91777b8e92e1f48c548d5fccd1beb">Neuromag::~Neuromag</a>()</div><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;{</div><div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="a05739.html#ab2d0a4130af1d1ed9347e0395d75ee7f">m_pNeuromagProducer</a>-&gt;isRunning() || this-&gt;isRunning())</div><div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;        <a class="code" href="a05739.html#a9da6195e0d4b8ed545819f76bb759542">stop</a>();</div><div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;}</div><div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;</div><div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;</div><div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;<span class="comment">//*************************************************************************************************************</span></div><div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;</div><div class="line"><a name="l00150"></a><span class="lineno"><a class="line" href="a05739.html#aa7cfea5120d3afa75552bbb94d28dcbb">  150</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="a05739.html#aa7cfea5120d3afa75552bbb94d28dcbb">Neuromag::clear</a>()</div><div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;{</div><div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;    <a class="code" href="a05739.html#a90b606b0ef040a1176adf11e214cb2b7">m_pFiffInfo</a>.reset();</div><div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;    <a class="code" href="a05739.html#abe02119444771d0408b96601268f251c">m_iBufferSize</a> = -1;</div><div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;}</div><div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;</div><div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;</div><div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;<span class="comment">//*************************************************************************************************************</span></div><div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;</div><div class="line"><a name="l00159"></a><span class="lineno"><a class="line" href="a05739.html#a574d516063ed8f905bd560216297fef4">  159</a></span>&#160;QSharedPointer&lt;SCSHAREDLIB::IPlugin&gt; <a class="code" href="a05739.html#a574d516063ed8f905bd560216297fef4">Neuromag::clone</a>()<span class="keyword"> const</span></div><div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;<span class="keyword"></span>{</div><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;    QSharedPointer&lt;Neuromag&gt; pNeuromagClone(<span class="keyword">new</span> <a class="code" href="a05739.html#a43e8a68cb028823fbbff3eccf373f7e8">Neuromag</a>());</div><div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;    <span class="keywordflow">return</span> pNeuromagClone;</div><div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;}</div><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;</div><div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;</div><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;<span class="comment">//*************************************************************************************************************</span></div><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;</div><div class="line"><a name="l00168"></a><span class="lineno"><a class="line" href="a05739.html#a62cebb76cc9355c50fce551e738d7e49">  168</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="a05739.html#a62cebb76cc9355c50fce551e738d7e49">Neuromag::init</a>()</div><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;{</div><div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;    <span class="comment">//Neuromag data Path</span></div><div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;    QString sNeuromagDataPath = QDir::homePath() + <span class="stringliteral">&quot;/NeuromagData&quot;</span>;</div><div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;    <span class="keywordflow">if</span>(!QDir(sNeuromagDataPath).exists()) {</div><div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;        QDir().mkdir(sNeuromagDataPath);</div><div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;    }</div><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;</div><div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;    <span class="comment">//Test Project</span></div><div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;    QSettings settings;</div><div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;    QString sCurrentProject = settings.value(QString(<span class="stringliteral">&quot;Plugin/%1/currentProject&quot;</span>).arg(<a class="code" href="a05739.html#aa6750cff0fc8b89409b914a7a136837b">getName</a>()), <span class="stringliteral">&quot;TestProject&quot;</span>).toString();</div><div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;    <span class="keywordflow">if</span>(!QDir(sNeuromagDataPath+<span class="stringliteral">&quot;/&quot;</span>+sCurrentProject).exists()) {</div><div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;        QDir().mkdir(sNeuromagDataPath+<span class="stringliteral">&quot;/&quot;</span>+sCurrentProject);</div><div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;    }</div><div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;</div><div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;    <span class="comment">//Test Subject</span></div><div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;    QString sCurrentSubject = settings.value(QString(<span class="stringliteral">&quot;Plugin/%1/currentSubject&quot;</span>).arg(<a class="code" href="a05739.html#aa6750cff0fc8b89409b914a7a136837b">getName</a>()), <span class="stringliteral">&quot;TestSubject&quot;</span>).toString();</div><div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;    <span class="keywordflow">if</span>(!QDir(sNeuromagDataPath+<span class="stringliteral">&quot;/&quot;</span>+sCurrentProject+<span class="stringliteral">&quot;/&quot;</span>+sCurrentSubject).exists()) {</div><div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;        QDir().mkdir(sNeuromagDataPath+<span class="stringliteral">&quot;/&quot;</span>+sCurrentProject+<span class="stringliteral">&quot;/&quot;</span>+sCurrentSubject);</div><div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;    }</div><div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;</div><div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;    <a class="code" href="a05739.html#a49a1d5bf8f7a3ceeee8cc4d04ec4aaad">m_pProjectSettingsView</a> = QSharedPointer&lt;ProjectSettingsView&gt;::create(sNeuromagDataPath,</div><div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;                                                                         sCurrentProject,</div><div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;                                                                         sCurrentSubject,</div><div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;                                                                         <span class="stringliteral">&quot;&quot;</span>);</div><div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;    <a class="code" href="a05739.html#a89532d17562bbaf138b0fb98f0e6d053">m_sRecordFile</a> = <a class="code" href="a05739.html#a49a1d5bf8f7a3ceeee8cc4d04ec4aaad">m_pProjectSettingsView</a>-&gt;getCurrentFileName();</div><div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;</div><div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;    connect(<a class="code" href="a05739.html#a49a1d5bf8f7a3ceeee8cc4d04ec4aaad">m_pProjectSettingsView</a>.data(), &amp;ProjectSettingsView::timerChanged,</div><div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;            <span class="keyword">this</span>, &amp;<a class="code" href="a05739.html#ae49c9d429c3265337af3b5b3bacb645e">Neuromag::setRecordingTimerChanged</a>);</div><div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;</div><div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;    connect(<a class="code" href="a05739.html#a49a1d5bf8f7a3ceeee8cc4d04ec4aaad">m_pProjectSettingsView</a>.data(), &amp;ProjectSettingsView::recordingTimerStateChanged,</div><div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;            <span class="keyword">this</span>, &amp;<a class="code" href="a05739.html#a5a1289155d53136d533dab5ad6ea95d2">Neuromag::setRecordingTimerStateChanged</a>);</div><div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;</div><div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;    <a class="code" href="a05739.html#a49a1d5bf8f7a3ceeee8cc4d04ec4aaad">m_pProjectSettingsView</a>-&gt;hide();</div><div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;</div><div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;    <span class="comment">// Start NeuromagProducer</span></div><div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;    <a class="code" href="a05739.html#ab2d0a4130af1d1ed9347e0395d75ee7f">m_pNeuromagProducer</a>-&gt;start();</div><div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;</div><div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;    <span class="comment">//init channels when fiff info is available</span></div><div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;    connect(<span class="keyword">this</span>, &amp;<a class="code" href="a05739.html#ae18bc444f6ee71365b0f617238ff18fc">Neuromag::fiffInfoAvailable</a>,</div><div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;            <span class="keyword">this</span>, &amp;<a class="code" href="a05739.html#ad2ee550ac0ed407684ec8b37a8f2f755">Neuromag::initConnector</a>);</div><div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;</div><div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;    <span class="comment">//Try to connect the cmd client on start up using localhost connection</span></div><div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;    this-&gt;<a class="code" href="a05739.html#a5e7ce7693d625c23cff480d3a19cd710">connectCmdClient</a>();</div><div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;}</div><div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;</div><div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;</div><div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;<span class="comment">//*************************************************************************************************************</span></div><div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;</div><div class="line"><a name="l00217"></a><span class="lineno"><a class="line" href="a05739.html#aec05e7f1a65fdb8ddeb14271def3dc80">  217</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="a05739.html#aec05e7f1a65fdb8ddeb14271def3dc80">Neuromag::unload</a>()</div><div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;{</div><div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;</div><div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;}</div><div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;</div><div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;</div><div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;<span class="comment">//*************************************************************************************************************</span></div><div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;</div><div class="line"><a name="l00225"></a><span class="lineno"><a class="line" href="a05739.html#a69de0f8b7594e2b8d15442818bec2971">  225</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="a05739.html#a69de0f8b7594e2b8d15442818bec2971">Neuromag::showProjectDialog</a>()</div><div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;{</div><div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="a05739.html#a49a1d5bf8f7a3ceeee8cc4d04ec4aaad">m_pProjectSettingsView</a>) {</div><div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;        <a class="code" href="a05739.html#a49a1d5bf8f7a3ceeee8cc4d04ec4aaad">m_pProjectSettingsView</a>-&gt;show();</div><div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;    }</div><div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;}</div><div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;</div><div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;</div><div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;<span class="comment">//*************************************************************************************************************</span></div><div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;</div><div class="line"><a name="l00235"></a><span class="lineno"><a class="line" href="a05739.html#a030bf81ee2f2ba3aba209b0ee418965f">  235</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="a05739.html#a030bf81ee2f2ba3aba209b0ee418965f">Neuromag::splitRecordingFile</a>()</div><div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;{</div><div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;    qDebug() &lt;&lt; <span class="stringliteral">&quot;Neuromag::splitRecordingFile - Splitting recording file&quot;</span>;</div><div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;    ++<a class="code" href="a05739.html#aa3b8dc6f15f4217d8db21fd15063ae9f">m_iSplitCount</a>;</div><div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;    QString nextFileName = <a class="code" href="a05739.html#a89532d17562bbaf138b0fb98f0e6d053">m_sRecordFile</a>.remove(<span class="stringliteral">&quot;_raw.fif&quot;</span>);</div><div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;    nextFileName += QString(<span class="stringliteral">&quot;-%1_raw.fif&quot;</span>).arg(<a class="code" href="a05739.html#aa3b8dc6f15f4217d8db21fd15063ae9f">m_iSplitCount</a>);</div><div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;</div><div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;    <span class="comment">// Write the link to the next file</span></div><div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;    qint32 data;</div><div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;    <a class="code" href="a05739.html#a37ab8299ad08ca4474550290835b5e3e">m_pOutfid</a>-&gt;start_block(<a class="code" href="a00893.html#a03bc7495a53759399050c03521bebccd">FIFFB_REF</a>);</div><div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;    data = FIFFV_ROLE_NEXT_FILE;</div><div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;    <a class="code" href="a05739.html#a37ab8299ad08ca4474550290835b5e3e">m_pOutfid</a>-&gt;write_int(FIFF_REF_ROLE,&amp;data);</div><div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;    <a class="code" href="a05739.html#a37ab8299ad08ca4474550290835b5e3e">m_pOutfid</a>-&gt;write_string(FIFF_REF_FILE_NAME, nextFileName);</div><div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;    <a class="code" href="a05739.html#a37ab8299ad08ca4474550290835b5e3e">m_pOutfid</a>-&gt;write_id(FIFF_REF_FILE_ID);<span class="comment">//ToDo meas_id</span></div><div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;    data = <a class="code" href="a05739.html#aa3b8dc6f15f4217d8db21fd15063ae9f">m_iSplitCount</a> - 1;</div><div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;    <a class="code" href="a05739.html#a37ab8299ad08ca4474550290835b5e3e">m_pOutfid</a>-&gt;write_int(FIFF_REF_FILE_NUM, &amp;data);</div><div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;    <a class="code" href="a05739.html#a37ab8299ad08ca4474550290835b5e3e">m_pOutfid</a>-&gt;end_block(<a class="code" href="a00893.html#a03bc7495a53759399050c03521bebccd">FIFFB_REF</a>);</div><div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;</div><div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;    <span class="comment">//finish file</span></div><div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;    <a class="code" href="a05739.html#a37ab8299ad08ca4474550290835b5e3e">m_pOutfid</a>-&gt;finish_writing_raw();</div><div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;</div><div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;    <span class="comment">//start next file</span></div><div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;    <a class="code" href="a05739.html#a29adab253255ee9c2536b0c74a907329">m_qFileOut</a>.setFileName(nextFileName);</div><div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;    RowVectorXd cals;</div><div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;    <a class="code" href="a05739.html#a37ab8299ad08ca4474550290835b5e3e">m_pOutfid</a> = <a class="code" href="a03955.html#ae30c7c07310e3393aa3bd223116b3c55">FiffStream::start_writing_raw</a>(<a class="code" href="a05739.html#a29adab253255ee9c2536b0c74a907329">m_qFileOut</a>,</div><div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;                                              *<a class="code" href="a05739.html#a90b606b0ef040a1176adf11e214cb2b7">m_pFiffInfo</a>,</div><div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;                                              cals);</div><div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;    fiff_int_t first = 0;</div><div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;    <a class="code" href="a05739.html#a37ab8299ad08ca4474550290835b5e3e">m_pOutfid</a>-&gt;write_int(<a class="code" href="a00893.html#a591e66b9fcd3973990a7ce37b5c04874">FIFF_FIRST_SAMPLE</a>, &amp;first);</div><div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;}</div><div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;</div><div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;</div><div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;<span class="comment">//*************************************************************************************************************</span></div><div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;</div><div class="line"><a name="l00269"></a><span class="lineno"><a class="line" href="a05739.html#a2a9dff5bc13ed078be5b91def8e34d13">  269</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="a05739.html#a2a9dff5bc13ed078be5b91def8e34d13">Neuromag::toggleRecordingFile</a>()</div><div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;{</div><div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;    <span class="comment">//Setup writing to file</span></div><div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="a05739.html#acb3d9326b070dd4bab73550efe5c1262">m_bWriteToFile</a>) {</div><div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;        m_mutex.lock();</div><div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;        <a class="code" href="a05739.html#a37ab8299ad08ca4474550290835b5e3e">m_pOutfid</a>-&gt;finish_writing_raw();</div><div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;        m_mutex.unlock();</div><div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;</div><div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;        <a class="code" href="a05739.html#acb3d9326b070dd4bab73550efe5c1262">m_bWriteToFile</a> = <span class="keyword">false</span>;</div><div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;        <a class="code" href="a05739.html#aa3b8dc6f15f4217d8db21fd15063ae9f">m_iSplitCount</a> = 0;</div><div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;</div><div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;        <span class="comment">//Stop record timer</span></div><div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;        <a class="code" href="a05739.html#ad189cae0a60196c69a91b679fa7a9cae">m_pRecordTimer</a>-&gt;stop();</div><div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;        <a class="code" href="a05739.html#af8443795bb2af50bc684598341bff000">m_pUpdateTimeInfoTimer</a>-&gt;stop();</div><div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;        <a class="code" href="a05739.html#ada25b5fa428e010b621081bcd9a104fe">m_pBlinkingRecordButtonTimer</a>-&gt;stop();</div><div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;</div><div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;        <a class="code" href="a05739.html#ab6151b06b751d2323e5358038a29c953">m_pActionRecordFile</a>-&gt;setIcon(QIcon(<span class="stringliteral">&quot;:/images/record.png&quot;</span>));</div><div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;    } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;        <a class="code" href="a05739.html#aa3b8dc6f15f4217d8db21fd15063ae9f">m_iSplitCount</a> = 0;</div><div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;</div><div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;        <span class="keywordflow">if</span>(!<a class="code" href="a05739.html#a90b606b0ef040a1176adf11e214cb2b7">m_pFiffInfo</a>) {</div><div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;            QMessageBox msgBox;</div><div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;            msgBox.setText(<span class="stringliteral">&quot;FiffInfo missing!&quot;</span>);</div><div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;            msgBox.setWindowFlags(Qt::WindowStaysOnTopHint);</div><div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;            msgBox.exec();</div><div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;            <span class="keywordflow">return</span>;</div><div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;        }</div><div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;</div><div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;        <span class="keywordflow">if</span>(<a class="code" href="a05739.html#a90b606b0ef040a1176adf11e214cb2b7">m_pFiffInfo</a>-&gt;dev_head_t.trans.isIdentity()) {</div><div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;            QMessageBox msgBox;</div><div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;            msgBox.setText(<span class="stringliteral">&quot;It seems that no HPI fitting was performed. This is your last chance!&quot;</span>);</div><div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;            msgBox.setInformativeText(<span class="stringliteral">&quot; Do you want to continue without HPI fitting?&quot;</span>);</div><div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;            msgBox.setStandardButtons(QMessageBox::Yes | QMessageBox::No);</div><div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;            msgBox.setWindowFlags(Qt::WindowStaysOnTopHint);</div><div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;            <span class="keywordtype">int</span> ret = msgBox.exec();</div><div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;            <span class="keywordflow">if</span>(ret == QMessageBox::No)</div><div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;                <span class="keywordflow">return</span>;</div><div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;        }</div><div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;</div><div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;        <span class="comment">//Initiate the stream for writing to the fif file</span></div><div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;        <span class="keywordflow">if</span>(<a class="code" href="a05739.html#a49a1d5bf8f7a3ceeee8cc4d04ec4aaad">m_pProjectSettingsView</a>) {</div><div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;            <a class="code" href="a05739.html#a89532d17562bbaf138b0fb98f0e6d053">m_sRecordFile</a> = <a class="code" href="a05739.html#a49a1d5bf8f7a3ceeee8cc4d04ec4aaad">m_pProjectSettingsView</a>-&gt;getCurrentFileName();</div><div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;        }</div><div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;</div><div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;        <a class="code" href="a05739.html#a29adab253255ee9c2536b0c74a907329">m_qFileOut</a>.setFileName(<a class="code" href="a05739.html#a89532d17562bbaf138b0fb98f0e6d053">m_sRecordFile</a>);</div><div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;        <span class="keywordflow">if</span>(<a class="code" href="a05739.html#a29adab253255ee9c2536b0c74a907329">m_qFileOut</a>.exists()) {</div><div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;            QMessageBox msgBox;</div><div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;            msgBox.setText(<span class="stringliteral">&quot;The file you want to write already exists.&quot;</span>);</div><div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;            msgBox.setInformativeText(<span class="stringliteral">&quot;Do you want to overwrite this file?&quot;</span>);</div><div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;            msgBox.setStandardButtons(QMessageBox::Yes | QMessageBox::No);</div><div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;            msgBox.setWindowFlags(Qt::WindowStaysOnTopHint);</div><div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;            <span class="keywordtype">int</span> ret = msgBox.exec();</div><div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;            <span class="keywordflow">if</span>(ret == QMessageBox::No)</div><div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;                <span class="keywordflow">return</span>;</div><div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;        }</div><div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;</div><div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;        <span class="comment">//Set all projectors to zero before writing to file because we always write the raw data</span></div><div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;        <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0; i&lt;<a class="code" href="a05739.html#a90b606b0ef040a1176adf11e214cb2b7">m_pFiffInfo</a>-&gt;projs.size(); i++) {</div><div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;            <a class="code" href="a05739.html#a90b606b0ef040a1176adf11e214cb2b7">m_pFiffInfo</a>-&gt;projs[i].active = <span class="keyword">false</span>;</div><div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;        }</div><div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;</div><div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;        m_mutex.lock();</div><div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;        RowVectorXd cals;</div><div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;        <a class="code" href="a05739.html#a37ab8299ad08ca4474550290835b5e3e">m_pOutfid</a> = <a class="code" href="a03955.html#ae30c7c07310e3393aa3bd223116b3c55">FiffStream::start_writing_raw</a>(<a class="code" href="a05739.html#a29adab253255ee9c2536b0c74a907329">m_qFileOut</a>,</div><div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;                                                  *<a class="code" href="a05739.html#a90b606b0ef040a1176adf11e214cb2b7">m_pFiffInfo</a>,</div><div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;                                                  cals);</div><div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;        fiff_int_t first = 0;</div><div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;        <a class="code" href="a05739.html#a37ab8299ad08ca4474550290835b5e3e">m_pOutfid</a>-&gt;write_int(<a class="code" href="a00893.html#a591e66b9fcd3973990a7ce37b5c04874">FIFF_FIRST_SAMPLE</a>, &amp;first);</div><div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;        m_mutex.unlock();</div><div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;</div><div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;        <a class="code" href="a05739.html#acb3d9326b070dd4bab73550efe5c1262">m_bWriteToFile</a> = <span class="keyword">true</span>;</div><div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;</div><div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;        <span class="comment">//Start timers for record button blinking, recording timer and updating the elapsed time in the proj widget</span></div><div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;        <a class="code" href="a05739.html#ada25b5fa428e010b621081bcd9a104fe">m_pBlinkingRecordButtonTimer</a>-&gt;start(500);</div><div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;        <a class="code" href="a05739.html#a9c5909eac6205cedf2e3e9d68f634618">m_recordingStartedTime</a>.restart();</div><div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;        <a class="code" href="a05739.html#af8443795bb2af50bc684598341bff000">m_pUpdateTimeInfoTimer</a>-&gt;start(1000);</div><div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;</div><div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;        <span class="keywordflow">if</span>(<a class="code" href="a05739.html#ad2ff08de5a91fdc2ee42e45d5a6eacbc">m_bUseRecordTimer</a>) {</div><div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;            <a class="code" href="a05739.html#ad189cae0a60196c69a91b679fa7a9cae">m_pRecordTimer</a>-&gt;start(<a class="code" href="a05739.html#a20eaaf7e43b08b73880669b2ffe70033">m_iRecordingMSeconds</a>);</div><div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;        }</div><div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;    }</div><div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;}</div><div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;</div><div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;</div><div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;<span class="comment">//*************************************************************************************************************</span></div><div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;</div><div class="line"><a name="l00355"></a><span class="lineno"><a class="line" href="a05739.html#ae49c9d429c3265337af3b5b3bacb645e">  355</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="a05739.html#ae49c9d429c3265337af3b5b3bacb645e">Neuromag::setRecordingTimerChanged</a>(<span class="keywordtype">int</span> timeMSecs)</div><div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;{</div><div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;    <span class="comment">//If the recording time is changed during the recording, change the timer</span></div><div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="a05739.html#acb3d9326b070dd4bab73550efe5c1262">m_bWriteToFile</a>) {</div><div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;        <a class="code" href="a05739.html#ad189cae0a60196c69a91b679fa7a9cae">m_pRecordTimer</a>-&gt;setInterval(timeMSecs-<a class="code" href="a05739.html#a9c5909eac6205cedf2e3e9d68f634618">m_recordingStartedTime</a>.elapsed());</div><div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;    }</div><div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;</div><div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;    <a class="code" href="a05739.html#a20eaaf7e43b08b73880669b2ffe70033">m_iRecordingMSeconds</a> = timeMSecs;</div><div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;}</div><div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;</div><div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;</div><div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;<span class="comment">//*************************************************************************************************************</span></div><div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;</div><div class="line"><a name="l00368"></a><span class="lineno"><a class="line" href="a05739.html#a5a1289155d53136d533dab5ad6ea95d2">  368</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="a05739.html#a5a1289155d53136d533dab5ad6ea95d2">Neuromag::setRecordingTimerStateChanged</a>(<span class="keywordtype">bool</span> state)</div><div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;{</div><div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;    <a class="code" href="a05739.html#ad2ff08de5a91fdc2ee42e45d5a6eacbc">m_bUseRecordTimer</a> = state;</div><div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;}</div><div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;</div><div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;</div><div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;<span class="comment">//*************************************************************************************************************</span></div><div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;</div><div class="line"><a name="l00376"></a><span class="lineno"><a class="line" href="a05739.html#ac9a8b5d3a003954765c0f36e1bdfe0e9">  376</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="a05739.html#ac9a8b5d3a003954765c0f36e1bdfe0e9">Neuromag::changeConnector</a>(qint32 p_iNewConnectorId)</div><div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;{</div><div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;    <span class="keywordflow">if</span>(p_iNewConnectorId != <a class="code" href="a05739.html#acf5ab2881854d8cf36f0a51c0904a981">m_iActiveConnectorId</a>)</div><div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;    {</div><div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;        <span class="comment">// read meas info</span></div><div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;        (*m_pRtCmdClient)[<span class="stringliteral">&quot;selcon&quot;</span>].pValues()[0].setValue(p_iNewConnectorId);</div><div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;        (*m_pRtCmdClient)[<span class="stringliteral">&quot;selcon&quot;</span>].send();</div><div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;</div><div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;        <a class="code" href="a05739.html#acf5ab2881854d8cf36f0a51c0904a981">m_iActiveConnectorId</a> = p_iNewConnectorId;</div><div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;</div><div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;        <span class="comment">// clear all and request everything new</span></div><div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;        <a class="code" href="a05739.html#aa7cfea5120d3afa75552bbb94d28dcbb">clear</a>();</div><div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;</div><div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;        <span class="comment">//</span></div><div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;        <span class="comment">// request available commands</span></div><div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;        <span class="comment">//</span></div><div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;        <a class="code" href="a05739.html#ac31257c6d11583e9a1564f93585e32cf">m_pRtCmdClient</a>-&gt;requestCommands();</div><div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;</div><div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;        <span class="comment">//</span></div><div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;        <span class="comment">// Read Info</span></div><div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;        <span class="comment">//</span></div><div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;        <span class="keywordflow">if</span>(!<a class="code" href="a05739.html#a90b606b0ef040a1176adf11e214cb2b7">m_pFiffInfo</a>)</div><div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;            <a class="code" href="a05739.html#a2eb1ce43d90854e10286188a9a7e43b8">requestInfo</a>();</div><div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;</div><div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;        <span class="comment">//</span></div><div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;        <span class="comment">// Read Buffer Size</span></div><div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;        <span class="comment">//</span></div><div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;        <a class="code" href="a05739.html#abe02119444771d0408b96601268f251c">m_iBufferSize</a> = <a class="code" href="a05739.html#ac31257c6d11583e9a1564f93585e32cf">m_pRtCmdClient</a>-&gt;requestBufsize();</div><div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;</div><div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;        emit <a class="code" href="a05739.html#ae8052de736b012a7603a7f723a724215">cmdConnectionChanged</a>(<a class="code" href="a05739.html#aaf67e93182c599dbd6473564013c8a9c">m_bCmdClientIsConnected</a>);</div><div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;    }</div><div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;}</div><div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;</div><div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;</div><div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;<span class="comment">//*************************************************************************************************************</span></div><div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;</div><div class="line"><a name="l00412"></a><span class="lineno"><a class="line" href="a05739.html#a631f3f774dfb24a86f2845168bdce82a">  412</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="a05739.html#a631f3f774dfb24a86f2845168bdce82a">Neuromag::start</a>()</div><div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;{</div><div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;<span class="comment">//    //Check if the thread is already or still running. This can happen if the start button is pressed immediately after the stop button was pressed. In this case the stopping process is not finished yet but the start process is initiated.</span></div><div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;<span class="comment">//    if(this-&gt;isRunning()) {</span></div><div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;<span class="comment">//        QThread::wait();</span></div><div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;<span class="comment">//    }</span></div><div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;</div><div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="a05739.html#aaf67e93182c599dbd6473564013c8a9c">m_bCmdClientIsConnected</a> &amp;&amp; <a class="code" href="a05739.html#a90b606b0ef040a1176adf11e214cb2b7">m_pFiffInfo</a>) {</div><div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;        <span class="comment">// Initialize real time measurements</span></div><div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;        <a class="code" href="a05739.html#a62cebb76cc9355c50fce551e738d7e49">init</a>();</div><div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;</div><div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;        <span class="comment">//Set buffer size</span></div><div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;        (*m_pRtCmdClient)[<span class="stringliteral">&quot;bufsize&quot;</span>].pValues()[0].setValue(<a class="code" href="a05739.html#abe02119444771d0408b96601268f251c">m_iBufferSize</a>);</div><div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;        (*m_pRtCmdClient)[<span class="stringliteral">&quot;bufsize&quot;</span>].send();</div><div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;</div><div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;        <span class="comment">// Buffer</span></div><div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;        <a class="code" href="a05739.html#a823ae7bf2f539ad74e3ec7564ba5454b">m_pRawMatrixBuffer_In</a> = QSharedPointer&lt;RawMatrixBuffer&gt;(<span class="keyword">new</span> <a class="code" href="a01562.html#ad7df02aae3c32f72eb464055f493cae9">RawMatrixBuffer</a>(8,<a class="code" href="a05739.html#a90b606b0ef040a1176adf11e214cb2b7">m_pFiffInfo</a>-&gt;nchan,<a class="code" href="a05739.html#abe02119444771d0408b96601268f251c">m_iBufferSize</a>));</div><div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;</div><div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;        <a class="code" href="a05739.html#ad328b40b99e3d0aa026f83ec84d68105">m_bIsRunning</a> = <span class="keyword">true</span>;</div><div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;</div><div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;        <span class="comment">// Start threads</span></div><div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;        QThread::start();</div><div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;</div><div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;        <a class="code" href="a05739.html#ab2d0a4130af1d1ed9347e0395d75ee7f">m_pNeuromagProducer</a>-&gt;start();</div><div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;</div><div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;        <span class="keywordflow">while</span>(!<a class="code" href="a05739.html#ab2d0a4130af1d1ed9347e0395d75ee7f">m_pNeuromagProducer</a>-&gt;m_bFlagMeasuring)</div><div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;            msleep(1);</div><div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;</div><div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;        <span class="comment">// Start Measurement at rt_Server</span></div><div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;        <span class="comment">// start measurement</span></div><div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;        (*m_pRtCmdClient)[<span class="stringliteral">&quot;start&quot;</span>].pValues()[0].setValue(<a class="code" href="a05739.html#ab2d0a4130af1d1ed9347e0395d75ee7f">m_pNeuromagProducer</a>-&gt;m_iDataClientId);</div><div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;        (*m_pRtCmdClient)[<span class="stringliteral">&quot;start&quot;</span>].send();</div><div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;</div><div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;    } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;        <span class="keywordflow">if</span>(!<a class="code" href="a05739.html#a90b606b0ef040a1176adf11e214cb2b7">m_pFiffInfo</a>) {</div><div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;            qWarning()&lt;&lt;<span class="stringliteral">&quot;Neuromag::start - FiffInfo is empty (NULL).&quot;</span>;</div><div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;        }</div><div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;        <span class="keywordflow">if</span>(!<a class="code" href="a05739.html#aaf67e93182c599dbd6473564013c8a9c">m_bCmdClientIsConnected</a>) {</div><div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;            qWarning()&lt;&lt;<span class="stringliteral">&quot;Neuromag::start - m_bCmdClientIsConnected is false.&quot;</span>;</div><div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;        }</div><div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;    }</div><div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;}</div><div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;</div><div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;</div><div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;<span class="comment">//*************************************************************************************************************</span></div><div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;</div><div class="line"><a name="l00460"></a><span class="lineno"><a class="line" href="a05739.html#a9da6195e0d4b8ed545819f76bb759542">  460</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="a05739.html#a9da6195e0d4b8ed545819f76bb759542">Neuromag::stop</a>()</div><div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;{</div><div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="a05739.html#ab2d0a4130af1d1ed9347e0395d75ee7f">m_pNeuromagProducer</a>-&gt;isRunning()) {</div><div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;        <a class="code" href="a05739.html#ab2d0a4130af1d1ed9347e0395d75ee7f">m_pNeuromagProducer</a>-&gt;stop();</div><div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;    }</div><div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;</div><div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;    <span class="comment">//Wait until this thread (TMSI) is stopped</span></div><div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;    <a class="code" href="a05739.html#ad328b40b99e3d0aa026f83ec84d68105">m_bIsRunning</a> = <span class="keyword">false</span>;</div><div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;</div><div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;    <span class="keywordflow">if</span>(this-&gt;isRunning())  {</div><div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;        <span class="comment">//In case the semaphore blocks the thread -&gt; Release the QSemaphore and let it exit from the pop function (acquire statement)</span></div><div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;        <a class="code" href="a05739.html#a823ae7bf2f539ad74e3ec7564ba5454b">m_pRawMatrixBuffer_In</a>-&gt;releaseFromPop();</div><div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;</div><div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;        <a class="code" href="a05739.html#a823ae7bf2f539ad74e3ec7564ba5454b">m_pRawMatrixBuffer_In</a>-&gt;clear();</div><div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;</div><div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;        <a class="code" href="a05739.html#a50fb6b6aba30a87fc3ca940a15b90f67">m_pRTMSA_Neuromag</a>-&gt;data()-&gt;clear();</div><div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;    }</div><div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;</div><div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="a05739.html#a5f18b9ce76a795b5dc0cf0d9d33d9824">m_pHPIWidget</a>) {</div><div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;        <a class="code" href="a05739.html#a5f18b9ce76a795b5dc0cf0d9d33d9824">m_pHPIWidget</a>-&gt;hide();</div><div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;    }</div><div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;</div><div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;}</div><div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;</div><div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;</div><div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;<span class="comment">//*************************************************************************************************************</span></div><div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;</div><div class="line"><a name="l00488"></a><span class="lineno"><a class="line" href="a05739.html#a5d7244a253bc9f76077e8bf9c3453226">  488</a></span>&#160;<a class="code" href="a05351.html#addfb10f54b9f7aaed5a12ad5665d8b5d">IPlugin::PluginType</a> <a class="code" href="a05739.html#a5d7244a253bc9f76077e8bf9c3453226">Neuromag::getType</a>()<span class="keyword"> const</span></div><div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;<span class="keyword"></span>{</div><div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="a05351.html#addfb10f54b9f7aaed5a12ad5665d8b5da86f46a40444d051a5b7ace338f27dedd">_ISensor</a>;</div><div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;}</div><div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;</div><div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;</div><div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;<span class="comment">//*************************************************************************************************************</span></div><div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;</div><div class="line"><a name="l00496"></a><span class="lineno"><a class="line" href="a05739.html#aa6750cff0fc8b89409b914a7a136837b">  496</a></span>&#160;QString <a class="code" href="a05739.html#aa6750cff0fc8b89409b914a7a136837b">Neuromag::getName</a>()<span class="keyword"> const</span></div><div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;<span class="keyword"></span>{</div><div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;    <span class="keywordflow">return</span> <span class="stringliteral">&quot;Neuromag&quot;</span>;</div><div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;}</div><div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;</div><div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;</div><div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;<span class="comment">//*************************************************************************************************************</span></div><div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;</div><div class="line"><a name="l00504"></a><span class="lineno"><a class="line" href="a05739.html#a9a47400770b759f9a822ecf1271996e9">  504</a></span>&#160;QWidget* <a class="code" href="a05739.html#a9a47400770b759f9a822ecf1271996e9">Neuromag::setupWidget</a>()</div><div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;{</div><div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;    <a class="code" href="a05735.html">NeuromagSetupWidget</a>* widget = <span class="keyword">new</span> <a class="code" href="a05735.html">NeuromagSetupWidget</a>(<span class="keyword">this</span>);<span class="comment">//widget is later distroyed by CentralWidget - so it has to be created everytime new</span></div><div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;</div><div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;    <span class="keywordflow">return</span> widget;</div><div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;}</div><div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;</div><div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;</div><div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;<span class="comment">//*************************************************************************************************************</span></div><div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;</div><div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;<span class="keywordtype">bool</span> Neuromag::readProjectors()</div><div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;{</div><div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;    QFile t_headerFiffFile(<a class="code" href="a05739.html#ac53a0ca6ab7bccc4350030137974dc99">m_sFiffHeader</a>);</div><div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;</div><div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;    <span class="comment">//</span></div><div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;    <span class="comment">//   Open the file</span></div><div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;    <span class="comment">//</span></div><div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;    <a class="code" href="a03955.html#afc5bb6ae857cf5e93e4e0271bf0bee05">FiffStream::SPtr</a> t_pStream(<span class="keyword">new</span> <a class="code" href="a03955.html">FiffStream</a>(&amp;t_headerFiffFile));</div><div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;    QString t_sFileName = t_pStream-&gt;streamName();</div><div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;</div><div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;    printf(<span class="stringliteral">&quot;Opening header data %s...\n&quot;</span>,t_sFileName.toUtf8().constData());</div><div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;</div><div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;    <span class="keywordflow">if</span>(!t_pStream-&gt;open()) {</div><div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;    }</div><div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;</div><div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;    QList&lt;FiffProj&gt; q_ListProj = t_pStream-&gt;read_proj(t_pStream-&gt;dirtree());</div><div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;</div><div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;    <span class="keywordflow">if</span> (q_ListProj.size() == 0) {</div><div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;        printf(<span class="stringliteral">&quot;Could not find projectors\n&quot;</span>);</div><div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;    }</div><div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;</div><div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;    <a class="code" href="a05739.html#a90b606b0ef040a1176adf11e214cb2b7">m_pFiffInfo</a>-&gt;projs = q_ListProj;</div><div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;</div><div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;    <span class="comment">//</span></div><div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;    <span class="comment">//   Activate the projection items</span></div><div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;    <span class="comment">//</span></div><div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;    <span class="keywordflow">for</span> (qint32 k = 0; k &lt; <a class="code" href="a05739.html#a90b606b0ef040a1176adf11e214cb2b7">m_pFiffInfo</a>-&gt;projs.size(); ++k) {</div><div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;        <a class="code" href="a05739.html#a90b606b0ef040a1176adf11e214cb2b7">m_pFiffInfo</a>-&gt;projs[k].active = <span class="keyword">true</span>;</div><div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;    }</div><div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;</div><div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;    <span class="comment">//garbage collecting</span></div><div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;    t_pStream-&gt;close();</div><div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;</div><div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;}</div><div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;</div><div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;</div><div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;<span class="comment">//*************************************************************************************************************</span></div><div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;</div><div class="line"><a name="l00555"></a><span class="lineno"><a class="line" href="a05739.html#a5e7ce7693d625c23cff480d3a19cd710">  555</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="a05739.html#a5e7ce7693d625c23cff480d3a19cd710">Neuromag::connectCmdClient</a>()</div><div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;{</div><div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="a05739.html#ac31257c6d11583e9a1564f93585e32cf">m_pRtCmdClient</a>.isNull())</div><div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;        <a class="code" href="a05739.html#ac31257c6d11583e9a1564f93585e32cf">m_pRtCmdClient</a> = QSharedPointer&lt;RtCmdClient&gt;(<span class="keyword">new</span> <a class="code" href="a03247.html">RtCmdClient</a>);</div><div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span>(<a class="code" href="a05739.html#aaf67e93182c599dbd6473564013c8a9c">m_bCmdClientIsConnected</a>)</div><div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;        this-&gt;<a class="code" href="a05739.html#a9fd10d614b2e51156e5f5db1ab99e5c4">disconnectCmdClient</a>();</div><div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;</div><div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;    <a class="code" href="a05739.html#ac31257c6d11583e9a1564f93585e32cf">m_pRtCmdClient</a>-&gt;connectToHost(<a class="code" href="a05739.html#afe3b1350c8b23fb51c1e5c592084e2c5">m_sNeuromagIP</a>);</div><div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;    <a class="code" href="a05739.html#ac31257c6d11583e9a1564f93585e32cf">m_pRtCmdClient</a>-&gt;waitForConnected(1000);</div><div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;</div><div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="a05739.html#ac31257c6d11583e9a1564f93585e32cf">m_pRtCmdClient</a>-&gt;state() == QTcpSocket::ConnectedState)</div><div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;    {</div><div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;        m_mutex.lock();</div><div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;</div><div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;        <span class="keywordflow">if</span>(!<a class="code" href="a05739.html#aaf67e93182c599dbd6473564013c8a9c">m_bCmdClientIsConnected</a>)</div><div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;        {</div><div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;            <span class="comment">//</span></div><div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;            <span class="comment">// request available commands</span></div><div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;            <span class="comment">//</span></div><div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;            <a class="code" href="a05739.html#ac31257c6d11583e9a1564f93585e32cf">m_pRtCmdClient</a>-&gt;requestCommands();</div><div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;</div><div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;            <span class="comment">//</span></div><div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;            <span class="comment">// set cmd client is connected</span></div><div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;            <span class="comment">//</span></div><div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;            <a class="code" href="a05739.html#aaf67e93182c599dbd6473564013c8a9c">m_bCmdClientIsConnected</a> = <span class="keyword">true</span>;</div><div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;</div><div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;            <span class="comment">//</span></div><div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;            <span class="comment">// Read Info</span></div><div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;            <span class="comment">//</span></div><div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;            <span class="keywordflow">if</span>(!<a class="code" href="a05739.html#a90b606b0ef040a1176adf11e214cb2b7">m_pFiffInfo</a>)</div><div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;                <a class="code" href="a05739.html#a2eb1ce43d90854e10286188a9a7e43b8">requestInfo</a>();</div><div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;</div><div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;            <span class="comment">// This will read projectors from an external file and replace the one received from mne_rt_server</span></div><div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;            <span class="comment">//if(m_pFiffInfo)</span></div><div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;            <span class="comment">//    readProjectors();</span></div><div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;</div><div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;            <span class="comment">//</span></div><div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;            <span class="comment">// Read Connectors</span></div><div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;            <span class="comment">//</span></div><div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;            <span class="keywordflow">if</span>(<a class="code" href="a05739.html#a39a26f4dd945e8da498c5d3cda38a20b">m_qMapConnectors</a>.size() == 0)</div><div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;                <a class="code" href="a05739.html#acf5ab2881854d8cf36f0a51c0904a981">m_iActiveConnectorId</a> = <a class="code" href="a05739.html#ac31257c6d11583e9a1564f93585e32cf">m_pRtCmdClient</a>-&gt;requestConnectors(<a class="code" href="a05739.html#a39a26f4dd945e8da498c5d3cda38a20b">m_qMapConnectors</a>);</div><div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;</div><div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;            QMap&lt;qint32, QString&gt;::const_iterator it;</div><div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;            <span class="keywordflow">for</span>(it = <a class="code" href="a05739.html#a39a26f4dd945e8da498c5d3cda38a20b">m_qMapConnectors</a>.begin(); it != <a class="code" href="a05739.html#a39a26f4dd945e8da498c5d3cda38a20b">m_qMapConnectors</a>.end(); ++it)</div><div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;                <span class="keywordflow">if</span>(it.value().compare(<span class="stringliteral">&quot;Neuromag Connector&quot;</span>) == 0 &amp;&amp; <a class="code" href="a05739.html#acf5ab2881854d8cf36f0a51c0904a981">m_iActiveConnectorId</a> != it.key())</div><div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;                    <a class="code" href="a05739.html#ac9a8b5d3a003954765c0f36e1bdfe0e9">changeConnector</a>(it.key());</div><div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;</div><div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;            <span class="comment">//</span></div><div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;            <span class="comment">// Read Buffer Size</span></div><div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;            <span class="comment">//</span></div><div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;            <a class="code" href="a05739.html#abe02119444771d0408b96601268f251c">m_iBufferSize</a> = <a class="code" href="a05739.html#ac31257c6d11583e9a1564f93585e32cf">m_pRtCmdClient</a>-&gt;requestBufsize();</div><div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;</div><div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;            emit <a class="code" href="a05739.html#ae8052de736b012a7603a7f723a724215">cmdConnectionChanged</a>(<a class="code" href="a05739.html#aaf67e93182c599dbd6473564013c8a9c">m_bCmdClientIsConnected</a>);</div><div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;        }</div><div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;        m_mutex.unlock();</div><div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;    }</div><div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;}</div><div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;</div><div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;</div><div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;<span class="comment">//*************************************************************************************************************</span></div><div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;</div><div class="line"><a name="l00616"></a><span class="lineno"><a class="line" href="a05739.html#a9fd10d614b2e51156e5f5db1ab99e5c4">  616</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="a05739.html#a9fd10d614b2e51156e5f5db1ab99e5c4">Neuromag::disconnectCmdClient</a>()</div><div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;{</div><div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="a05739.html#aaf67e93182c599dbd6473564013c8a9c">m_bCmdClientIsConnected</a>)</div><div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;    {</div><div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;        <a class="code" href="a05739.html#ac31257c6d11583e9a1564f93585e32cf">m_pRtCmdClient</a>-&gt;disconnectFromHost();</div><div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;        <a class="code" href="a05739.html#ac31257c6d11583e9a1564f93585e32cf">m_pRtCmdClient</a>-&gt;waitForDisconnected();</div><div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;        m_mutex.lock();</div><div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;        <a class="code" href="a05739.html#aaf67e93182c599dbd6473564013c8a9c">m_bCmdClientIsConnected</a> = <span class="keyword">false</span>;</div><div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;        m_mutex.unlock();</div><div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;        emit <a class="code" href="a05739.html#ae8052de736b012a7603a7f723a724215">cmdConnectionChanged</a>(<a class="code" href="a05739.html#aaf67e93182c599dbd6473564013c8a9c">m_bCmdClientIsConnected</a>);</div><div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;    }</div><div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;}</div><div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;</div><div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;</div><div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;<span class="comment">//*************************************************************************************************************</span></div><div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;</div><div class="line"><a name="l00632"></a><span class="lineno"><a class="line" href="a05739.html#a2eb1ce43d90854e10286188a9a7e43b8">  632</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="a05739.html#a2eb1ce43d90854e10286188a9a7e43b8">Neuromag::requestInfo</a>()</div><div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;{</div><div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;    <span class="keywordflow">while</span>(!(<a class="code" href="a05739.html#ab2d0a4130af1d1ed9347e0395d75ee7f">m_pNeuromagProducer</a>-&gt;m_iDataClientId &gt; -1 &amp;&amp; <a class="code" href="a05739.html#aaf67e93182c599dbd6473564013c8a9c">m_bCmdClientIsConnected</a>))</div><div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;        qWarning() &lt;&lt; <span class="stringliteral">&quot;NeuromagProducer is not running! Retry...&quot;</span>;</div><div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;</div><div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="a05739.html#ab2d0a4130af1d1ed9347e0395d75ee7f">m_pNeuromagProducer</a>-&gt;m_iDataClientId &gt; -1 &amp;&amp; <a class="code" href="a05739.html#aaf67e93182c599dbd6473564013c8a9c">m_bCmdClientIsConnected</a>)</div><div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;    {</div><div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;        <span class="comment">// read meas info</span></div><div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;        (*m_pRtCmdClient)[<span class="stringliteral">&quot;measinfo&quot;</span>].pValues()[0].setValue(<a class="code" href="a05739.html#ab2d0a4130af1d1ed9347e0395d75ee7f">m_pNeuromagProducer</a>-&gt;m_iDataClientId);</div><div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;        (*m_pRtCmdClient)[<span class="stringliteral">&quot;measinfo&quot;</span>].send();</div><div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;</div><div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;        <a class="code" href="a05739.html#ab2d0a4130af1d1ed9347e0395d75ee7f">m_pNeuromagProducer</a>-&gt;m_mutex.lock();</div><div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;        <a class="code" href="a05739.html#ab2d0a4130af1d1ed9347e0395d75ee7f">m_pNeuromagProducer</a>-&gt;m_bFlagInfoRequest = <span class="keyword">true</span>;</div><div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;        <a class="code" href="a05739.html#ab2d0a4130af1d1ed9347e0395d75ee7f">m_pNeuromagProducer</a>-&gt;m_mutex.unlock();</div><div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;    }</div><div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;    <span class="keywordflow">else</span></div><div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;        qWarning() &lt;&lt; <span class="stringliteral">&quot;NeuromagProducer is not connected!&quot;</span>;</div><div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;}</div><div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;</div><div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;</div><div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;<span class="comment">//*************************************************************************************************************</span></div><div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;</div><div class="line"><a name="l00654"></a><span class="lineno"><a class="line" href="a05739.html#a59bd8c551f75a29d811cccb6ecf32d4e">  654</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="a05739.html#a59bd8c551f75a29d811cccb6ecf32d4e">Neuromag::run</a>()</div><div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;{</div><div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;    MatrixXf matValue;</div><div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;</div><div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;    qint32 size = 0;</div><div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;</div><div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;    <span class="keywordflow">while</span>(<a class="code" href="a05739.html#ad328b40b99e3d0aa026f83ec84d68105">m_bIsRunning</a>) {</div><div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;        <span class="keywordflow">if</span>(<a class="code" href="a05739.html#a823ae7bf2f539ad74e3ec7564ba5454b">m_pRawMatrixBuffer_In</a>) {</div><div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;            <span class="comment">//pop matrix</span></div><div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;            matValue = <a class="code" href="a05739.html#a823ae7bf2f539ad74e3ec7564ba5454b">m_pRawMatrixBuffer_In</a>-&gt;pop();</div><div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;</div><div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;            <span class="comment">//Write raw data to fif file</span></div><div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;            <span class="keywordflow">if</span>(<a class="code" href="a05739.html#acb3d9326b070dd4bab73550efe5c1262">m_bWriteToFile</a>) {</div><div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;                size += matValue.rows()*matValue.cols() * 4;</div><div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;</div><div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;                <span class="keywordflow">if</span>(size &gt; MAX_DATA_LEN) {</div><div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;                    size = 0;</div><div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;                    this-&gt;<a class="code" href="a05739.html#a030bf81ee2f2ba3aba209b0ee418965f">splitRecordingFile</a>();</div><div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;                }</div><div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;</div><div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;                m_mutex.lock();</div><div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;                <span class="keywordflow">if</span>(<a class="code" href="a05739.html#a37ab8299ad08ca4474550290835b5e3e">m_pOutfid</a>) {</div><div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;                    <a class="code" href="a05739.html#a37ab8299ad08ca4474550290835b5e3e">m_pOutfid</a>-&gt;write_raw_buffer(matValue.cast&lt;<span class="keywordtype">double</span>&gt;());</div><div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;                }</div><div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;                m_mutex.unlock();</div><div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;            } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;                size = 0;</div><div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;            }</div><div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;</div><div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;            <span class="keywordflow">if</span>(<a class="code" href="a05739.html#a50fb6b6aba30a87fc3ca940a15b90f67">m_pRTMSA_Neuromag</a>) {</div><div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;                <a class="code" href="a05739.html#a50fb6b6aba30a87fc3ca940a15b90f67">m_pRTMSA_Neuromag</a>-&gt;data()-&gt;setValue(this-&gt;<a class="code" href="a05739.html#aefc2016fb07b1436bb5430935a8de158">calibrate</a>(matValue));</div><div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;            }</div><div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;        }</div><div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;    }</div><div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;}</div><div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;</div><div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;</div><div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;<span class="comment">//*************************************************************************************************************</span></div><div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;</div><div class="line"><a name="l00693"></a><span class="lineno"><a class="line" href="a05739.html#aefc2016fb07b1436bb5430935a8de158">  693</a></span>&#160;MatrixXd <a class="code" href="a05739.html#aefc2016fb07b1436bb5430935a8de158">Neuromag::calibrate</a>(<span class="keyword">const</span> MatrixXf&amp; data)</div><div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;{</div><div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;    MatrixXd one;</div><div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="a05739.html#a90b606b0ef040a1176adf11e214cb2b7">m_pFiffInfo</a> &amp;&amp; <a class="code" href="a05739.html#af6918f1b2a29a9247e98d104b4e99dd1">m_sparseMatCals</a>.cols() == <a class="code" href="a05739.html#a90b606b0ef040a1176adf11e214cb2b7">m_pFiffInfo</a>-&gt;nchan) {</div><div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;        one = <a class="code" href="a05739.html#af6918f1b2a29a9247e98d104b4e99dd1">m_sparseMatCals</a>*data.cast&lt;<span class="keywordtype">double</span>&gt;();</div><div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;    } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;        one = data.cast&lt;<span class="keywordtype">double</span>&gt;();</div><div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;    }</div><div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;</div><div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;    <span class="keywordflow">return</span> one;</div><div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;}</div><div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;</div><div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;</div><div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;<span class="comment">//*************************************************************************************************************</span></div><div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;</div><div class="line"><a name="l00708"></a><span class="lineno"><a class="line" href="a05739.html#ad0750b6f0a0d19582a54eb4524a6ce83">  708</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="a05739.html#ad0750b6f0a0d19582a54eb4524a6ce83">Neuromag::changeRecordingButton</a>()</div><div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;{</div><div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="a05739.html#a4aef78004414bcfdf1bd5d6432b401d1">m_iBlinkStatus</a> == 0) {</div><div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;        <a class="code" href="a05739.html#ab6151b06b751d2323e5358038a29c953">m_pActionRecordFile</a>-&gt;setIcon(QIcon(<span class="stringliteral">&quot;:/images/record.png&quot;</span>));</div><div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;        <a class="code" href="a05739.html#a4aef78004414bcfdf1bd5d6432b401d1">m_iBlinkStatus</a> = 1;</div><div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;    } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;        <a class="code" href="a05739.html#ab6151b06b751d2323e5358038a29c953">m_pActionRecordFile</a>-&gt;setIcon(QIcon(<span class="stringliteral">&quot;:/images/record_active.png&quot;</span>));</div><div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;        <a class="code" href="a05739.html#a4aef78004414bcfdf1bd5d6432b401d1">m_iBlinkStatus</a> = 0;</div><div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;    }</div><div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;}</div><div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;</div><div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;</div><div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;<span class="comment">//*************************************************************************************************************</span></div><div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;</div><div class="line"><a name="l00722"></a><span class="lineno"><a class="line" href="a05739.html#a69ee359f00d290e1b24ecc8875ffceeb">  722</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="a05739.html#a69ee359f00d290e1b24ecc8875ffceeb">Neuromag::onRecordingRemainingTimeChange</a>()</div><div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;{</div><div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;    <a class="code" href="a05739.html#a49a1d5bf8f7a3ceeee8cc4d04ec4aaad">m_pProjectSettingsView</a>-&gt;setRecordingElapsedTime(<a class="code" href="a05739.html#a9c5909eac6205cedf2e3e9d68f634618">m_recordingStartedTime</a>.elapsed());</div><div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;}</div><div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;</div><div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;</div><div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;<span class="comment">//*************************************************************************************************************</span></div><div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;</div><div class="line"><a name="l00730"></a><span class="lineno"><a class="line" href="a05739.html#ad2ee550ac0ed407684ec8b37a8f2f755">  730</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="a05739.html#ad2ee550ac0ed407684ec8b37a8f2f755">Neuromag::initConnector</a>()</div><div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;{</div><div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="a05739.html#a90b606b0ef040a1176adf11e214cb2b7">m_pFiffInfo</a>)</div><div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;    {</div><div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;        <a class="code" href="a05739.html#a50fb6b6aba30a87fc3ca940a15b90f67">m_pRTMSA_Neuromag</a> = <a class="code" href="a05391.html">PluginOutputData&lt;RealTimeMultiSampleArray&gt;::create</a>(<span class="keyword">this</span>, <span class="stringliteral">&quot;Realtime&quot;</span>, <span class="stringliteral">&quot;MNE Rt Client&quot;</span>);</div><div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;</div><div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;        <a class="code" href="a05739.html#a50fb6b6aba30a87fc3ca940a15b90f67">m_pRTMSA_Neuromag</a>-&gt;data()-&gt;initFromFiffInfo(<a class="code" href="a05739.html#a90b606b0ef040a1176adf11e214cb2b7">m_pFiffInfo</a>);</div><div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;        <a class="code" href="a05739.html#a50fb6b6aba30a87fc3ca940a15b90f67">m_pRTMSA_Neuromag</a>-&gt;data()-&gt;setMultiArraySize(1);</div><div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;</div><div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;        <a class="code" href="a05739.html#a50fb6b6aba30a87fc3ca940a15b90f67">m_pRTMSA_Neuromag</a>-&gt;data()-&gt;setVisibility(<span class="keyword">true</span>);</div><div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;</div><div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;        <a class="code" href="a05739.html#a50fb6b6aba30a87fc3ca940a15b90f67">m_pRTMSA_Neuromag</a>-&gt;data()-&gt;setXMLLayoutFile(<span class="stringliteral">&quot;./resources/mne_scan/plugins/Neuromag/VectorViewLayout.xml&quot;</span>);</div><div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;</div><div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;        <a class="code" href="a05351.html#a3d20989cd2175fa71bf77ceb0c99f353">m_outputConnectors</a>.append(<a class="code" href="a05739.html#a50fb6b6aba30a87fc3ca940a15b90f67">m_pRTMSA_Neuromag</a>);</div><div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;</div><div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;        <span class="comment">//Add the calibration factors</span></div><div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;        <a class="code" href="a05739.html#aaa7b95b4afe117ce22059385a8007fb6">m_cals</a> = RowVectorXd(<a class="code" href="a05739.html#a90b606b0ef040a1176adf11e214cb2b7">m_pFiffInfo</a>-&gt;nchan);</div><div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;        <a class="code" href="a05739.html#aaa7b95b4afe117ce22059385a8007fb6">m_cals</a>.setZero();</div><div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;        <span class="keywordflow">for</span> (qint32 k = 0; k &lt; <a class="code" href="a05739.html#a90b606b0ef040a1176adf11e214cb2b7">m_pFiffInfo</a>-&gt;nchan; ++k) {</div><div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;            <a class="code" href="a05739.html#aaa7b95b4afe117ce22059385a8007fb6">m_cals</a>[k] = <a class="code" href="a05739.html#a90b606b0ef040a1176adf11e214cb2b7">m_pFiffInfo</a>-&gt;chs[k].range*<a class="code" href="a05739.html#a90b606b0ef040a1176adf11e214cb2b7">m_pFiffInfo</a>-&gt;chs[k].cal;</div><div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;        }</div><div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;</div><div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;        <span class="comment">//Initialize the data and calibration vector</span></div><div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;        <span class="keyword">typedef</span> Eigen::Triplet&lt;double&gt; T;</div><div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;        std::vector&lt;T&gt; tripletList;</div><div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;        tripletList.reserve(<a class="code" href="a05739.html#a90b606b0ef040a1176adf11e214cb2b7">m_pFiffInfo</a>-&gt;nchan);</div><div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;        <span class="keywordflow">for</span>(qint32 i = 0; i &lt; <a class="code" href="a05739.html#a90b606b0ef040a1176adf11e214cb2b7">m_pFiffInfo</a>-&gt;nchan; ++i) {</div><div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;            tripletList.push_back(T(i, i, this-&gt;<a class="code" href="a05739.html#aaa7b95b4afe117ce22059385a8007fb6">m_cals</a>[i]));</div><div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;        }</div><div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;</div><div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;        <a class="code" href="a05739.html#af6918f1b2a29a9247e98d104b4e99dd1">m_sparseMatCals</a> = SparseMatrix&lt;double&gt;(<a class="code" href="a05739.html#a90b606b0ef040a1176adf11e214cb2b7">m_pFiffInfo</a>-&gt;nchan, <a class="code" href="a05739.html#a90b606b0ef040a1176adf11e214cb2b7">m_pFiffInfo</a>-&gt;nchan);</div><div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;        <a class="code" href="a05739.html#af6918f1b2a29a9247e98d104b4e99dd1">m_sparseMatCals</a>.setFromTriplets(tripletList.begin(), tripletList.end());</div><div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;    }</div><div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;}</div><div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;</div><div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;</div><div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;<span class="comment">//*************************************************************************************************************</span></div><div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;</div><div class="line"><a name="l00768"></a><span class="lineno"><a class="line" href="a05739.html#a61b5f2a5422bac2f377496a86df73d01">  768</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="a05739.html#a61b5f2a5422bac2f377496a86df73d01">Neuromag::showHPIDialog</a>()</div><div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;{</div><div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;    <span class="keywordflow">if</span>(!<a class="code" href="a05739.html#a90b606b0ef040a1176adf11e214cb2b7">m_pFiffInfo</a>) {</div><div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;        QMessageBox msgBox;</div><div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;        msgBox.setText(<span class="stringliteral">&quot;FiffInfo missing!&quot;</span>);</div><div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;        msgBox.exec();</div><div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;        <span class="keywordflow">return</span>;</div><div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;    } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;        <span class="keywordflow">if</span> (!<a class="code" href="a05739.html#a5f18b9ce76a795b5dc0cf0d9d33d9824">m_pHPIWidget</a>) {</div><div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;            <a class="code" href="a05739.html#a5f18b9ce76a795b5dc0cf0d9d33d9824">m_pHPIWidget</a> = QSharedPointer&lt;HpiView&gt;(<span class="keyword">new</span> <a class="code" href="a03783.html">HpiView</a>(<a class="code" href="a05739.html#a90b606b0ef040a1176adf11e214cb2b7">m_pFiffInfo</a>));</div><div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;        }</div><div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;</div><div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;        <span class="keywordflow">if</span> (!<a class="code" href="a05739.html#a5f18b9ce76a795b5dc0cf0d9d33d9824">m_pHPIWidget</a>-&gt;isVisible()) {</div><div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;            <a class="code" href="a05739.html#a5f18b9ce76a795b5dc0cf0d9d33d9824">m_pHPIWidget</a>-&gt;show();</div><div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;            <a class="code" href="a05739.html#a5f18b9ce76a795b5dc0cf0d9d33d9824">m_pHPIWidget</a>-&gt;raise();</div><div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;        }</div><div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;    }</div><div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;}</div><div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;</div><div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;</div><div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;<span class="comment">//*************************************************************************************************************</span></div><div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;</div><div class="line"><a name="l00790"></a><span class="lineno"><a class="line" href="a05739.html#a201ef7949a1b9c4b41bda7dd8b21fba9">  790</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="a05739.html#a201ef7949a1b9c4b41bda7dd8b21fba9">Neuromag::updateHPI</a>(<span class="keyword">const</span> MatrixXf&amp; matData)</div><div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;{</div><div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="a05739.html#a90b606b0ef040a1176adf11e214cb2b7">m_pFiffInfo</a> &amp;&amp; <a class="code" href="a05739.html#a5f18b9ce76a795b5dc0cf0d9d33d9824">m_pHPIWidget</a>) {</div><div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;        <a class="code" href="a05739.html#a5f18b9ce76a795b5dc0cf0d9d33d9824">m_pHPIWidget</a>-&gt;setData(this-&gt;<a class="code" href="a05739.html#aefc2016fb07b1436bb5430935a8de158">calibrate</a>(matData));</div><div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;    }</div><div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;}</div><div class="ttc" id="a05739_html_a59bd8c551f75a29d811cccb6ecf32d4e"><div class="ttname"><a href="a05739.html#a59bd8c551f75a29d811cccb6ecf32d4e">NEUROMAGPLUGIN::Neuromag::run</a></div><div class="ttdeci">virtual void run()</div><div class="ttdef"><b>Definition:</b> <a href="a06370_source.html#l00654">neuromag.cpp:654</a></div></div>
<div class="ttc" id="a03955_html_ae30c7c07310e3393aa3bd223116b3c55"><div class="ttname"><a href="a03955.html#ae30c7c07310e3393aa3bd223116b3c55">FIFFLIB::FiffStream::start_writing_raw</a></div><div class="ttdeci">static FiffStream::SPtr start_writing_raw(QIODevice &amp;p_IODevice, const FiffInfo &amp;info, RowVectorXd &amp;cals, MatrixXi sel=defaultMatrixXi, bool bResetRange=true)</div><div class="ttdef"><b>Definition:</b> <a href="a00947_source.html#l01990">fiff_stream.cpp:1990</a></div></div>
<div class="ttc" id="a05735_html"><div class="ttname"><a href="a05735.html">NEUROMAGPLUGIN::NeuromagSetupWidget</a></div><div class="ttdoc">The NeuromagSetupWidget class provides the ECG configuration window. </div><div class="ttdef"><b>Definition:</b> <a href="a02795_source.html#l00079">neuromagsetupwidget.h:79</a></div></div>
<div class="ttc" id="a05739_html_a5f18b9ce76a795b5dc0cf0d9d33d9824"><div class="ttname"><a href="a05739.html#a5f18b9ce76a795b5dc0cf0d9d33d9824">NEUROMAGPLUGIN::Neuromag::m_pHPIWidget</a></div><div class="ttdeci">QSharedPointer&lt; DISP3DLIB::HpiView &gt; m_pHPIWidget</div><div class="ttdef"><b>Definition:</b> <a href="a06376_source.html#l00302">neuromag.h:302</a></div></div>
<div class="ttc" id="a00893_html_a03bc7495a53759399050c03521bebccd"><div class="ttname"><a href="a00893.html#a03bc7495a53759399050c03521bebccd">FIFFB_REF</a></div><div class="ttdeci">#define FIFFB_REF</div><div class="ttdef"><b>Definition:</b> <a href="a00893_source.html#l00384">fiff_file.h:384</a></div></div>
<div class="ttc" id="a05739_html_a574d516063ed8f905bd560216297fef4"><div class="ttname"><a href="a05739.html#a574d516063ed8f905bd560216297fef4">NEUROMAGPLUGIN::Neuromag::clone</a></div><div class="ttdeci">virtual QSharedPointer&lt; SCSHAREDLIB::IPlugin &gt; clone() const</div><div class="ttdef"><b>Definition:</b> <a href="a06370_source.html#l00159">neuromag.cpp:159</a></div></div>
<div class="ttc" id="a05739_html_a29adab253255ee9c2536b0c74a907329"><div class="ttname"><a href="a05739.html#a29adab253255ee9c2536b0c74a907329">NEUROMAGPLUGIN::Neuromag::m_qFileOut</a></div><div class="ttdeci">QFile m_qFileOut</div><div class="ttdef"><b>Definition:</b> <a href="a06376_source.html#l00331">neuromag.h:331</a></div></div>
<div class="ttc" id="a05739_html_aefc2016fb07b1436bb5430935a8de158"><div class="ttname"><a href="a05739.html#aefc2016fb07b1436bb5430935a8de158">NEUROMAGPLUGIN::Neuromag::calibrate</a></div><div class="ttdeci">Eigen::MatrixXd calibrate(const Eigen::MatrixXf &amp;data)</div><div class="ttdef"><b>Definition:</b> <a href="a06370_source.html#l00693">neuromag.cpp:693</a></div></div>
<div class="ttc" id="a03955_html_afc5bb6ae857cf5e93e4e0271bf0bee05"><div class="ttname"><a href="a03955.html#afc5bb6ae857cf5e93e4e0271bf0bee05">FIFFLIB::FiffStream::SPtr</a></div><div class="ttdeci">QSharedPointer&lt; FiffStream &gt; SPtr</div><div class="ttdef"><b>Definition:</b> <a href="a00950_source.html#l00126">fiff_stream.h:126</a></div></div>
<div class="ttc" id="a02219_html"><div class="ttname"><a href="a02219.html">realtimemultisamplearray.h</a></div><div class="ttdoc">Contains the declaration of the RealTimeMultiSampleArray class. </div></div>
<div class="ttc" id="a05739_html_af8443795bb2af50bc684598341bff000"><div class="ttname"><a href="a05739.html#af8443795bb2af50bc684598341bff000">NEUROMAGPLUGIN::Neuromag::m_pUpdateTimeInfoTimer</a></div><div class="ttdeci">QSharedPointer&lt; QTimer &gt; m_pUpdateTimeInfoTimer</div><div class="ttdef"><b>Definition:</b> <a href="a06376_source.html#l00296">neuromag.h:296</a></div></div>
<div class="ttc" id="a05743_html"><div class="ttname"><a href="a05743.html">NEUROMAGPLUGIN::NeuromagProducer</a></div><div class="ttdoc">The NeuromagProducer class provides a Rt Client data producer for a given sampling rate...</div><div class="ttdef"><b>Definition:</b> <a href="a02801_source.html#l00095">neuromagproducer.h:95</a></div></div>
<div class="ttc" id="a05739_html_a69de0f8b7594e2b8d15442818bec2971"><div class="ttname"><a href="a05739.html#a69de0f8b7594e2b8d15442818bec2971">NEUROMAGPLUGIN::Neuromag::showProjectDialog</a></div><div class="ttdeci">void showProjectDialog()</div><div class="ttdef"><b>Definition:</b> <a href="a06370_source.html#l00225">neuromag.cpp:225</a></div></div>
<div class="ttc" id="a01562_html_ad7df02aae3c32f72eb464055f493cae9"><div class="ttname"><a href="a01562.html#ad7df02aae3c32f72eb464055f493cae9">IOBUFFER::RawMatrixBuffer</a></div><div class="ttdeci">UTILSSHARED_EXPORT _float_CircularMatrixBuffer RawMatrixBuffer</div><div class="ttdef"><b>Definition:</b> <a href="a01562_source.html#l00403">circularmatrixbuffer.h:403</a></div></div>
<div class="ttc" id="a05739_html_a61b5f2a5422bac2f377496a86df73d01"><div class="ttname"><a href="a05739.html#a61b5f2a5422bac2f377496a86df73d01">NEUROMAGPLUGIN::Neuromag::showHPIDialog</a></div><div class="ttdeci">void showHPIDialog()</div><div class="ttdef"><b>Definition:</b> <a href="a06370_source.html#l00768">neuromag.cpp:768</a></div></div>
<div class="ttc" id="a00950_html"><div class="ttname"><a href="a00950.html">fiff_stream.h</a></div><div class="ttdoc">FiffStream class declaration. </div></div>
<div class="ttc" id="a05351_html_addfb10f54b9f7aaed5a12ad5665d8b5da86f46a40444d051a5b7ace338f27dedd"><div class="ttname"><a href="a05351.html#addfb10f54b9f7aaed5a12ad5665d8b5da86f46a40444d051a5b7ace338f27dedd">SCSHAREDLIB::IPlugin::_ISensor</a></div><div class="ttdef"><b>Definition:</b> <a href="a02255_source.html#l00102">IPlugin.h:102</a></div></div>
<div class="ttc" id="a03247_html"><div class="ttname"><a href="a03247.html">COMMUNICATIONLIB::RtCmdClient</a></div><div class="ttdoc">Real-time command client. </div><div class="ttdef"><b>Definition:</b> <a href="a00014_source.html#l00084">rtcmdclient.h:84</a></div></div>
<div class="ttc" id="a03164_html"><div class="ttname"><a href="a03164.html">DISPLIB</a></div><div class="ttdef"><b>Definition:</b> <a href="a00173_source.html#l00079">bar.h:79</a></div></div>
<div class="ttc" id="a03162_html"><div class="ttname"><a href="a03162.html">FIFFLIB</a></div><div class="ttdef"><b>Definition:</b> <a href="a00059_source.html#l00079">connectivitysettings.h:79</a></div></div>
<div class="ttc" id="a03223_html"><div class="ttname"><a href="a03223.html">NEUROMAGPLUGIN</a></div><div class="ttdef"><b>Definition:</b> <a href="a02789_source.html#l00061">neuromagaboutwidget.h:61</a></div></div>
<div class="ttc" id="a02801_html"><div class="ttname"><a href="a02801.html">neuromagproducer.h</a></div><div class="ttdoc">Contains the declaration of the NeuromagProducer class. </div></div>
<div class="ttc" id="a05739_html_a9da6195e0d4b8ed545819f76bb759542"><div class="ttname"><a href="a05739.html#a9da6195e0d4b8ed545819f76bb759542">NEUROMAGPLUGIN::Neuromag::stop</a></div><div class="ttdeci">virtual bool stop()</div><div class="ttdef"><b>Definition:</b> <a href="a06370_source.html#l00460">neuromag.cpp:460</a></div></div>
<div class="ttc" id="a03167_html"><div class="ttname"><a href="a03167.html">UTILSLIB</a></div><div class="ttdef"><b>Definition:</b> <a href="a00317_source.html#l00078">filtersettingsview.h:78</a></div></div>
<div class="ttc" id="a05739_html_ad328b40b99e3d0aa026f83ec84d68105"><div class="ttname"><a href="a05739.html#ad328b40b99e3d0aa026f83ec84d68105">NEUROMAGPLUGIN::Neuromag::m_bIsRunning</a></div><div class="ttdeci">bool m_bIsRunning</div><div class="ttdef"><b>Definition:</b> <a href="a06376_source.html#l00316">neuromag.h:316</a></div></div>
<div class="ttc" id="a05739_html_acb3d9326b070dd4bab73550efe5c1262"><div class="ttname"><a href="a05739.html#acb3d9326b070dd4bab73550efe5c1262">NEUROMAGPLUGIN::Neuromag::m_bWriteToFile</a></div><div class="ttdeci">bool m_bWriteToFile</div><div class="ttdef"><b>Definition:</b> <a href="a06376_source.html#l00317">neuromag.h:317</a></div></div>
<div class="ttc" id="a03955_html"><div class="ttname"><a href="a03955.html">FIFFLIB::FiffStream</a></div><div class="ttdoc">FIFF File I/O routines. </div><div class="ttdef"><b>Definition:</b> <a href="a00950_source.html#l00123">fiff_stream.h:123</a></div></div>
<div class="ttc" id="a05739_html_ad2ee550ac0ed407684ec8b37a8f2f755"><div class="ttname"><a href="a05739.html#ad2ee550ac0ed407684ec8b37a8f2f755">NEUROMAGPLUGIN::Neuromag::initConnector</a></div><div class="ttdeci">void initConnector()</div><div class="ttdef"><b>Definition:</b> <a href="a06370_source.html#l00730">neuromag.cpp:730</a></div></div>
<div class="ttc" id="a00875_html"><div class="ttname"><a href="a00875.html">fiff_dir_node.h</a></div><div class="ttdoc">FiffDirNode class declaration, which provides fiff dir tree processing methods. </div></div>
<div class="ttc" id="a05739_html_a201ef7949a1b9c4b41bda7dd8b21fba9"><div class="ttname"><a href="a05739.html#a201ef7949a1b9c4b41bda7dd8b21fba9">NEUROMAGPLUGIN::Neuromag::updateHPI</a></div><div class="ttdeci">void updateHPI(const Eigen::MatrixXf &amp;matData)</div><div class="ttdef"><b>Definition:</b> <a href="a06370_source.html#l00790">neuromag.cpp:790</a></div></div>
<div class="ttc" id="a05739_html_aa7cfea5120d3afa75552bbb94d28dcbb"><div class="ttname"><a href="a05739.html#aa7cfea5120d3afa75552bbb94d28dcbb">NEUROMAGPLUGIN::Neuromag::clear</a></div><div class="ttdeci">void clear()</div><div class="ttdef"><b>Definition:</b> <a href="a06370_source.html#l00150">neuromag.cpp:150</a></div></div>
<div class="ttc" id="a03170_html"><div class="ttname"><a href="a03170.html">DISP3DLIB</a></div><div class="ttdef"><b>Definition:</b> <a href="a00482_source.html#l00076">data3Dtreedelegate.h:76</a></div></div>
<div class="ttc" id="a05739_html_a5d7244a253bc9f76077e8bf9c3453226"><div class="ttname"><a href="a05739.html#a5d7244a253bc9f76077e8bf9c3453226">NEUROMAGPLUGIN::Neuromag::getType</a></div><div class="ttdeci">virtual IPlugin::PluginType getType() const</div><div class="ttdef"><b>Definition:</b> <a href="a06370_source.html#l00488">neuromag.cpp:488</a></div></div>
<div class="ttc" id="a00014_html"><div class="ttname"><a href="a00014.html">rtcmdclient.h</a></div><div class="ttdoc">declaration of the RtCmdClient Class. </div></div>
<div class="ttc" id="a05739_html_a2a9dff5bc13ed078be5b91def8e34d13"><div class="ttname"><a href="a05739.html#a2a9dff5bc13ed078be5b91def8e34d13">NEUROMAGPLUGIN::Neuromag::toggleRecordingFile</a></div><div class="ttdeci">void toggleRecordingFile()</div><div class="ttdef"><b>Definition:</b> <a href="a06370_source.html#l00269">neuromag.cpp:269</a></div></div>
<div class="ttc" id="a05739_html_af6918f1b2a29a9247e98d104b4e99dd1"><div class="ttname"><a href="a05739.html#af6918f1b2a29a9247e98d104b4e99dd1">NEUROMAGPLUGIN::Neuromag::m_sparseMatCals</a></div><div class="ttdeci">Eigen::SparseMatrix&lt; double &gt; m_sparseMatCals</div><div class="ttdef"><b>Definition:</b> <a href="a06376_source.html#l00334">neuromag.h:334</a></div></div>
<div class="ttc" id="a05739_html_aaf67e93182c599dbd6473564013c8a9c"><div class="ttname"><a href="a05739.html#aaf67e93182c599dbd6473564013c8a9c">NEUROMAGPLUGIN::Neuromag::m_bCmdClientIsConnected</a></div><div class="ttdeci">bool m_bCmdClientIsConnected</div><div class="ttdef"><b>Definition:</b> <a href="a06376_source.html#l00315">neuromag.h:315</a></div></div>
<div class="ttc" id="a05739_html_aa3b8dc6f15f4217d8db21fd15063ae9f"><div class="ttname"><a href="a05739.html#aa3b8dc6f15f4217d8db21fd15063ae9f">NEUROMAGPLUGIN::Neuromag::m_iSplitCount</a></div><div class="ttdeci">qint32 m_iSplitCount</div><div class="ttdef"><b>Definition:</b> <a href="a06376_source.html#l00321">neuromag.h:321</a></div></div>
<div class="ttc" id="a05739_html_a43e8a68cb028823fbbff3eccf373f7e8"><div class="ttname"><a href="a05739.html#a43e8a68cb028823fbbff3eccf373f7e8">NEUROMAGPLUGIN::Neuromag::Neuromag</a></div><div class="ttdeci">Neuromag()</div><div class="ttdef"><b>Definition:</b> <a href="a06370_source.html#l00087">neuromag.cpp:87</a></div></div>
<div class="ttc" id="a05351_html_addfb10f54b9f7aaed5a12ad5665d8b5d"><div class="ttname"><a href="a05351.html#addfb10f54b9f7aaed5a12ad5665d8b5d">SCSHAREDLIB::IPlugin::PluginType</a></div><div class="ttdeci">PluginType</div><div class="ttdef"><b>Definition:</b> <a href="a02255_source.html#l00100">IPlugin.h:100</a></div></div>
<div class="ttc" id="a05739_html_a90b606b0ef040a1176adf11e214cb2b7"><div class="ttname"><a href="a05739.html#a90b606b0ef040a1176adf11e214cb2b7">NEUROMAGPLUGIN::Neuromag::m_pFiffInfo</a></div><div class="ttdeci">QSharedPointer&lt; FIFFLIB::FiffInfo &gt; m_pFiffInfo</div><div class="ttdef"><b>Definition:</b> <a href="a06376_source.html#l00301">neuromag.h:301</a></div></div>
<div class="ttc" id="a05739_html_aec05e7f1a65fdb8ddeb14271def3dc80"><div class="ttname"><a href="a05739.html#aec05e7f1a65fdb8ddeb14271def3dc80">NEUROMAGPLUGIN::Neuromag::unload</a></div><div class="ttdeci">virtual void unload()</div><div class="ttdef"><b>Definition:</b> <a href="a06370_source.html#l00217">neuromag.cpp:217</a></div></div>
<div class="ttc" id="a05739_html_a39a26f4dd945e8da498c5d3cda38a20b"><div class="ttname"><a href="a05739.html#a39a26f4dd945e8da498c5d3cda38a20b">NEUROMAGPLUGIN::Neuromag::m_qMapConnectors</a></div><div class="ttdeci">QMap&lt; qint32, QString &gt; m_qMapConnectors</div><div class="ttdef"><b>Definition:</b> <a href="a06376_source.html#l00326">neuromag.h:326</a></div></div>
<div class="ttc" id="a05739_html_a631f3f774dfb24a86f2845168bdce82a"><div class="ttname"><a href="a05739.html#a631f3f774dfb24a86f2845168bdce82a">NEUROMAGPLUGIN::Neuromag::start</a></div><div class="ttdeci">virtual bool start()</div><div class="ttdef"><b>Definition:</b> <a href="a06370_source.html#l00412">neuromag.cpp:412</a></div></div>
<div class="ttc" id="a05739_html_a823ae7bf2f539ad74e3ec7564ba5454b"><div class="ttname"><a href="a05739.html#a823ae7bf2f539ad74e3ec7564ba5454b">NEUROMAGPLUGIN::Neuromag::m_pRawMatrixBuffer_In</a></div><div class="ttdeci">QSharedPointer&lt; IOBUFFER::RawMatrixBuffer &gt; m_pRawMatrixBuffer_In</div><div class="ttdef"><b>Definition:</b> <a href="a06376_source.html#l00295">neuromag.h:295</a></div></div>
<div class="ttc" id="a05739_html_a9fd10d614b2e51156e5f5db1ab99e5c4"><div class="ttname"><a href="a05739.html#a9fd10d614b2e51156e5f5db1ab99e5c4">NEUROMAGPLUGIN::Neuromag::disconnectCmdClient</a></div><div class="ttdeci">void disconnectCmdClient()</div><div class="ttdef"><b>Definition:</b> <a href="a06370_source.html#l00616">neuromag.cpp:616</a></div></div>
<div class="ttc" id="a03183_html"><div class="ttname"><a href="a03183.html">IOBUFFER</a></div><div class="ttdef"><b>Definition:</b> <a href="a01547_source.html#l00060">buffer.h:60</a></div></div>
<div class="ttc" id="a03783_html"><div class="ttname"><a href="a03783.html">DISP3DLIB::HpiView</a></div><div class="ttdoc">The HpiView class provides a QDialog for the HPI controls. </div><div class="ttdef"><b>Definition:</b> <a href="a00773_source.html#l00110">hpiview.h:110</a></div></div>
<div class="ttc" id="a05739_html_afe3b1350c8b23fb51c1e5c592084e2c5"><div class="ttname"><a href="a05739.html#afe3b1350c8b23fb51c1e5c592084e2c5">NEUROMAGPLUGIN::Neuromag::m_sNeuromagIP</a></div><div class="ttdeci">QString m_sNeuromagIP</div><div class="ttdef"><b>Definition:</b> <a href="a06376_source.html#l00307">neuromag.h:307</a></div></div>
<div class="ttc" id="a05739_html_ac9a8b5d3a003954765c0f36e1bdfe0e9"><div class="ttname"><a href="a05739.html#ac9a8b5d3a003954765c0f36e1bdfe0e9">NEUROMAGPLUGIN::Neuromag::changeConnector</a></div><div class="ttdeci">void changeConnector(qint32 p_iNewConnectorId)</div><div class="ttdef"><b>Definition:</b> <a href="a06370_source.html#l00376">neuromag.cpp:376</a></div></div>
<div class="ttc" id="a05739_html_acf5ab2881854d8cf36f0a51c0904a981"><div class="ttname"><a href="a05739.html#acf5ab2881854d8cf36f0a51c0904a981">NEUROMAGPLUGIN::Neuromag::m_iActiveConnectorId</a></div><div class="ttdeci">qint32 m_iActiveConnectorId</div><div class="ttdef"><b>Definition:</b> <a href="a06376_source.html#l00323">neuromag.h:323</a></div></div>
<div class="ttc" id="a03205_html"><div class="ttname"><a href="a03205.html">SCSHAREDLIB</a></div><div class="ttdef"><b>Definition:</b> <a href="a02249_source.html#l00060">IAlgorithm.h:60</a></div></div>
<div class="ttc" id="a05739_html_a5e7ce7693d625c23cff480d3a19cd710"><div class="ttname"><a href="a05739.html#a5e7ce7693d625c23cff480d3a19cd710">NEUROMAGPLUGIN::Neuromag::connectCmdClient</a></div><div class="ttdeci">void connectCmdClient()</div><div class="ttdef"><b>Definition:</b> <a href="a06370_source.html#l00555">neuromag.cpp:555</a></div></div>
<div class="ttc" id="a01583_html"><div class="ttname"><a href="a01583.html">ioutils.h</a></div><div class="ttdoc">IOUtils class declaration. </div></div>
<div class="ttc" id="a02795_html"><div class="ttname"><a href="a02795.html">neuromagsetupwidget.h</a></div><div class="ttdoc">Contains the declaration of the NeuromagSetupWidget class. </div></div>
<div class="ttc" id="a00425_html"><div class="ttname"><a href="a00425.html">projectsettingsview.h</a></div><div class="ttdoc">Declaration of the ProjectSettingsView Class. </div></div>
<div class="ttc" id="a05739_html_a030bf81ee2f2ba3aba209b0ee418965f"><div class="ttname"><a href="a05739.html#a030bf81ee2f2ba3aba209b0ee418965f">NEUROMAGPLUGIN::Neuromag::splitRecordingFile</a></div><div class="ttdeci">void splitRecordingFile()</div><div class="ttdef"><b>Definition:</b> <a href="a06370_source.html#l00235">neuromag.cpp:235</a></div></div>
<div class="ttc" id="a05739_html_a20eaaf7e43b08b73880669b2ffe70033"><div class="ttname"><a href="a05739.html#a20eaaf7e43b08b73880669b2ffe70033">NEUROMAGPLUGIN::Neuromag::m_iRecordingMSeconds</a></div><div class="ttdeci">int m_iRecordingMSeconds</div><div class="ttdef"><b>Definition:</b> <a href="a06376_source.html#l00324">neuromag.h:324</a></div></div>
<div class="ttc" id="a05739_html_ab6c91777b8e92e1f48c548d5fccd1beb"><div class="ttname"><a href="a05739.html#ab6c91777b8e92e1f48c548d5fccd1beb">NEUROMAGPLUGIN::Neuromag::~Neuromag</a></div><div class="ttdeci">virtual ~Neuromag()</div><div class="ttdef"><b>Definition:</b> <a href="a06370_source.html#l00141">neuromag.cpp:141</a></div></div>
<div class="ttc" id="a05739_html_aaa7b95b4afe117ce22059385a8007fb6"><div class="ttname"><a href="a05739.html#aaa7b95b4afe117ce22059385a8007fb6">NEUROMAGPLUGIN::Neuromag::m_cals</a></div><div class="ttdeci">Eigen::RowVectorXd m_cals</div><div class="ttdef"><b>Definition:</b> <a href="a06376_source.html#l00333">neuromag.h:333</a></div></div>
<div class="ttc" id="a05739_html_a89532d17562bbaf138b0fb98f0e6d053"><div class="ttname"><a href="a05739.html#a89532d17562bbaf138b0fb98f0e6d053">NEUROMAGPLUGIN::Neuromag::m_sRecordFile</a></div><div class="ttdeci">QString m_sRecordFile</div><div class="ttdef"><b>Definition:</b> <a href="a06376_source.html#l00313">neuromag.h:313</a></div></div>
<div class="ttc" id="a05739_html_ae8052de736b012a7603a7f723a724215"><div class="ttname"><a href="a05739.html#ae8052de736b012a7603a7f723a724215">NEUROMAGPLUGIN::Neuromag::cmdConnectionChanged</a></div><div class="ttdeci">void cmdConnectionChanged(bool p_bStatus)</div></div>
<div class="ttc" id="a05739_html_a4aef78004414bcfdf1bd5d6432b401d1"><div class="ttname"><a href="a05739.html#a4aef78004414bcfdf1bd5d6432b401d1">NEUROMAGPLUGIN::Neuromag::m_iBlinkStatus</a></div><div class="ttdeci">qint16 m_iBlinkStatus</div><div class="ttdef"><b>Definition:</b> <a href="a06376_source.html#l00320">neuromag.h:320</a></div></div>
<div class="ttc" id="a05739_html_abd1e2a77ed4a2900a964673110403721"><div class="ttname"><a href="a05739.html#abd1e2a77ed4a2900a964673110403721">NEUROMAGPLUGIN::Neuromag::m_pActionSetupProject</a></div><div class="ttdeci">QPointer&lt; QAction &gt; m_pActionSetupProject</div><div class="ttdef"><b>Definition:</b> <a href="a06376_source.html#l00336">neuromag.h:336</a></div></div>
<div class="ttc" id="a05739_html_abe02119444771d0408b96601268f251c"><div class="ttname"><a href="a05739.html#abe02119444771d0408b96601268f251c">NEUROMAGPLUGIN::Neuromag::m_iBufferSize</a></div><div class="ttdeci">qint32 m_iBufferSize</div><div class="ttdef"><b>Definition:</b> <a href="a06376_source.html#l00322">neuromag.h:322</a></div></div>
<div class="ttc" id="a00908_html"><div class="ttname"><a href="a00908.html">fiff_info.h</a></div><div class="ttdoc">FiffInfo class declaration. </div></div>
<div class="ttc" id="a05739_html_ae49c9d429c3265337af3b5b3bacb645e"><div class="ttname"><a href="a05739.html#ae49c9d429c3265337af3b5b3bacb645e">NEUROMAGPLUGIN::Neuromag::setRecordingTimerChanged</a></div><div class="ttdeci">void setRecordingTimerChanged(int timeMSecs)</div><div class="ttdef"><b>Definition:</b> <a href="a06370_source.html#l00355">neuromag.cpp:355</a></div></div>
<div class="ttc" id="a05739_html_aa6750cff0fc8b89409b914a7a136837b"><div class="ttname"><a href="a05739.html#aa6750cff0fc8b89409b914a7a136837b">NEUROMAGPLUGIN::Neuromag::getName</a></div><div class="ttdeci">virtual QString getName() const</div><div class="ttdef"><b>Definition:</b> <a href="a06370_source.html#l00496">neuromag.cpp:496</a></div></div>
<div class="ttc" id="a05739_html_a2eb1ce43d90854e10286188a9a7e43b8"><div class="ttname"><a href="a05739.html#a2eb1ce43d90854e10286188a9a7e43b8">NEUROMAGPLUGIN::Neuromag::requestInfo</a></div><div class="ttdeci">void requestInfo()</div><div class="ttdef"><b>Definition:</b> <a href="a06370_source.html#l00632">neuromag.cpp:632</a></div></div>
<div class="ttc" id="a05739_html_a37ab8299ad08ca4474550290835b5e3e"><div class="ttname"><a href="a05739.html#a37ab8299ad08ca4474550290835b5e3e">NEUROMAGPLUGIN::Neuromag::m_pOutfid</a></div><div class="ttdeci">QSharedPointer&lt; FIFFLIB::FiffStream &gt; m_pOutfid</div><div class="ttdef"><b>Definition:</b> <a href="a06376_source.html#l00300">neuromag.h:300</a></div></div>
<div class="ttc" id="a00893_html_a591e66b9fcd3973990a7ce37b5c04874"><div class="ttname"><a href="a00893.html#a591e66b9fcd3973990a7ce37b5c04874">FIFF_FIRST_SAMPLE</a></div><div class="ttdeci">#define FIFF_FIRST_SAMPLE</div><div class="ttdef"><b>Definition:</b> <a href="a00893_source.html#l00465">fiff_file.h:465</a></div></div>
<div class="ttc" id="a05739_html_ae18bc444f6ee71365b0f617238ff18fc"><div class="ttname"><a href="a05739.html#ae18bc444f6ee71365b0f617238ff18fc">NEUROMAGPLUGIN::Neuromag::fiffInfoAvailable</a></div><div class="ttdeci">void fiffInfoAvailable()</div></div>
<div class="ttc" id="a05739_html_a5a1289155d53136d533dab5ad6ea95d2"><div class="ttname"><a href="a05739.html#a5a1289155d53136d533dab5ad6ea95d2">NEUROMAGPLUGIN::Neuromag::setRecordingTimerStateChanged</a></div><div class="ttdeci">void setRecordingTimerStateChanged(bool state)</div><div class="ttdef"><b>Definition:</b> <a href="a06370_source.html#l00368">neuromag.cpp:368</a></div></div>
<div class="ttc" id="a05739_html_a50fb6b6aba30a87fc3ca940a15b90f67"><div class="ttname"><a href="a05739.html#a50fb6b6aba30a87fc3ca940a15b90f67">NEUROMAGPLUGIN::Neuromag::m_pRTMSA_Neuromag</a></div><div class="ttdeci">QSharedPointer&lt; SCSHAREDLIB::PluginOutputData&lt; SCMEASLIB::RealTimeMultiSampleArray &gt; &gt; m_pRTMSA_Neuromag</div><div class="ttdef"><b>Definition:</b> <a href="a06376_source.html#l00291">neuromag.h:291</a></div></div>
<div class="ttc" id="a05739_html_ab6151b06b751d2323e5358038a29c953"><div class="ttname"><a href="a05739.html#ab6151b06b751d2323e5358038a29c953">NEUROMAGPLUGIN::Neuromag::m_pActionRecordFile</a></div><div class="ttdeci">QPointer&lt; QAction &gt; m_pActionRecordFile</div><div class="ttdef"><b>Definition:</b> <a href="a06376_source.html#l00337">neuromag.h:337</a></div></div>
<div class="ttc" id="a05739_html_ad189cae0a60196c69a91b679fa7a9cae"><div class="ttname"><a href="a05739.html#ad189cae0a60196c69a91b679fa7a9cae">NEUROMAGPLUGIN::Neuromag::m_pRecordTimer</a></div><div class="ttdeci">QSharedPointer&lt; QTimer &gt; m_pRecordTimer</div><div class="ttdef"><b>Definition:</b> <a href="a06376_source.html#l00298">neuromag.h:298</a></div></div>
<div class="ttc" id="a05739_html_a69ee359f00d290e1b24ecc8875ffceeb"><div class="ttname"><a href="a05739.html#a69ee359f00d290e1b24ecc8875ffceeb">NEUROMAGPLUGIN::Neuromag::onRecordingRemainingTimeChange</a></div><div class="ttdeci">void onRecordingRemainingTimeChange()</div><div class="ttdef"><b>Definition:</b> <a href="a06370_source.html#l00722">neuromag.cpp:722</a></div></div>
<div class="ttc" id="a05739_html_ac53a0ca6ab7bccc4350030137974dc99"><div class="ttname"><a href="a05739.html#ac53a0ca6ab7bccc4350030137974dc99">NEUROMAGPLUGIN::Neuromag::m_sFiffHeader</a></div><div class="ttdeci">QString m_sFiffHeader</div><div class="ttdef"><b>Definition:</b> <a href="a06376_source.html#l00308">neuromag.h:308</a></div></div>
<div class="ttc" id="a05391_html"><div class="ttname"><a href="a05391.html">SCSHAREDLIB::PluginOutputData</a></div><div class="ttdoc">PluginOutputConnector with specified Measurement. </div><div class="ttdef"><b>Definition:</b> <a href="a02312_source.html#l00072">pluginoutputdata.h:72</a></div></div>
<div class="ttc" id="a05739_html_ad0750b6f0a0d19582a54eb4524a6ce83"><div class="ttname"><a href="a05739.html#ad0750b6f0a0d19582a54eb4524a6ce83">NEUROMAGPLUGIN::Neuromag::changeRecordingButton</a></div><div class="ttdeci">void changeRecordingButton()</div><div class="ttdef"><b>Definition:</b> <a href="a06370_source.html#l00708">neuromag.cpp:708</a></div></div>
<div class="ttc" id="a05351_html_acd0c42811d473bfa88b5f280d3da6ca3"><div class="ttname"><a href="a05351.html#acd0c42811d473bfa88b5f280d3da6ca3">SCSHAREDLIB::IPlugin::addPluginAction</a></div><div class="ttdeci">void addPluginAction(QAction *pAction)</div><div class="ttdef"><b>Definition:</b> <a href="a02255_source.html#l00249">IPlugin.h:249</a></div></div>
<div class="ttc" id="a05739_html_ac31257c6d11583e9a1564f93585e32cf"><div class="ttname"><a href="a05739.html#ac31257c6d11583e9a1564f93585e32cf">NEUROMAGPLUGIN::Neuromag::m_pRtCmdClient</a></div><div class="ttdeci">QSharedPointer&lt; COMMUNICATIONLIB::RtCmdClient &gt; m_pRtCmdClient</div><div class="ttdef"><b>Definition:</b> <a href="a06376_source.html#l00293">neuromag.h:293</a></div></div>
<div class="ttc" id="a05739_html_a49a1d5bf8f7a3ceeee8cc4d04ec4aaad"><div class="ttname"><a href="a05739.html#a49a1d5bf8f7a3ceeee8cc4d04ec4aaad">NEUROMAGPLUGIN::Neuromag::m_pProjectSettingsView</a></div><div class="ttdeci">QSharedPointer&lt; DISPLIB::ProjectSettingsView &gt; m_pProjectSettingsView</div><div class="ttdef"><b>Definition:</b> <a href="a06376_source.html#l00299">neuromag.h:299</a></div></div>
<div class="ttc" id="a05739_html_ad2ff08de5a91fdc2ee42e45d5a6eacbc"><div class="ttname"><a href="a05739.html#ad2ff08de5a91fdc2ee42e45d5a6eacbc">NEUROMAGPLUGIN::Neuromag::m_bUseRecordTimer</a></div><div class="ttdeci">bool m_bUseRecordTimer</div><div class="ttdef"><b>Definition:</b> <a href="a06376_source.html#l00318">neuromag.h:318</a></div></div>
<div class="ttc" id="a05739_html_a62cebb76cc9355c50fce551e738d7e49"><div class="ttname"><a href="a05739.html#a62cebb76cc9355c50fce551e738d7e49">NEUROMAGPLUGIN::Neuromag::init</a></div><div class="ttdeci">virtual void init()</div><div class="ttdef"><b>Definition:</b> <a href="a06370_source.html#l00168">neuromag.cpp:168</a></div></div>
<div class="ttc" id="a05739_html_ada25b5fa428e010b621081bcd9a104fe"><div class="ttname"><a href="a05739.html#ada25b5fa428e010b621081bcd9a104fe">NEUROMAGPLUGIN::Neuromag::m_pBlinkingRecordButtonTimer</a></div><div class="ttdeci">QSharedPointer&lt; QTimer &gt; m_pBlinkingRecordButtonTimer</div><div class="ttdef"><b>Definition:</b> <a href="a06376_source.html#l00297">neuromag.h:297</a></div></div>
<div class="ttc" id="a05739_html_a9c5909eac6205cedf2e3e9d68f634618"><div class="ttname"><a href="a05739.html#a9c5909eac6205cedf2e3e9d68f634618">NEUROMAGPLUGIN::Neuromag::m_recordingStartedTime</a></div><div class="ttdeci">QTime m_recordingStartedTime</div><div class="ttdef"><b>Definition:</b> <a href="a06376_source.html#l00329">neuromag.h:329</a></div></div>
<div class="ttc" id="a05739_html_a2e065e423ca60a8fa38d4b71a7e0f1b4"><div class="ttname"><a href="a05739.html#a2e065e423ca60a8fa38d4b71a7e0f1b4">NEUROMAGPLUGIN::Neuromag::m_pActionComputeHPI</a></div><div class="ttdeci">QPointer&lt; QAction &gt; m_pActionComputeHPI</div><div class="ttdef"><b>Definition:</b> <a href="a06376_source.html#l00338">neuromag.h:338</a></div></div>
<div class="ttc" id="a00773_html"><div class="ttname"><a href="a00773.html">hpiview.h</a></div><div class="ttdoc">HpiView class declaration. </div></div>
<div class="ttc" id="a05739_html_ab2d0a4130af1d1ed9347e0395d75ee7f"><div class="ttname"><a href="a05739.html#ab2d0a4130af1d1ed9347e0395d75ee7f">NEUROMAGPLUGIN::Neuromag::m_pNeuromagProducer</a></div><div class="ttdeci">QSharedPointer&lt; NeuromagProducer &gt; m_pNeuromagProducer</div><div class="ttdef"><b>Definition:</b> <a href="a06376_source.html#l00294">neuromag.h:294</a></div></div>
<div class="ttc" id="a05351_html_a3d20989cd2175fa71bf77ceb0c99f353"><div class="ttname"><a href="a05351.html#a3d20989cd2175fa71bf77ceb0c99f353">SCSHAREDLIB::IPlugin::m_outputConnectors</a></div><div class="ttdeci">OutputConnectorList m_outputConnectors</div><div class="ttdef"><b>Definition:</b> <a href="a02255_source.html#l00222">IPlugin.h:222</a></div></div>
<div class="ttc" id="a05739_html_a9a47400770b759f9a822ecf1271996e9"><div class="ttname"><a href="a05739.html#a9a47400770b759f9a822ecf1271996e9">NEUROMAGPLUGIN::Neuromag::setupWidget</a></div><div class="ttdeci">virtual QWidget * setupWidget()</div><div class="ttdef"><b>Definition:</b> <a href="a06370_source.html#l00504">neuromag.cpp:504</a></div></div>
<div class="ttc" id="a03204_html"><div class="ttname"><a href="a03204.html">SCMEASLIB</a></div><div class="ttdef"><b>Definition:</b> <a href="a02138_source.html#l00078">realtimeconnectivityestimatewidget.h:78</a></div></div>
</div><!-- fragment --></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Wed Dec 18 2019 19:35:41
</small></address>
</body>
</html>